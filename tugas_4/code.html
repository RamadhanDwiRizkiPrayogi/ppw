
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1. Pembersihan Teks &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tugas_4/code';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/foto_profil.jpg" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="../_static/foto_profil.jpg" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Profile
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tugas_1/pengantar_ppw.html">Pengantar Web Mining</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tugas_2/web_crawling.html">web crawling - tugas 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tugas_3/web_crawling.html">Web Crawling - Tugas 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_crawling.html">preprocessing, tf-idf dan CBOW - Tugas 4</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Ftugas_4/code.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/tugas_4/code.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>1. Pembersihan Teks</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>1. Pembersihan Teks</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#tokenisasi"><strong>2. Tokenisasi</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#penghapusan-kata-umum-stop-words"><strong>3. Penghapusan Kata Umum (Stop Words)</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stemming-dan-lematisasi"><strong>4. Stemming dan Lematisasi</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#word-embeddings-dengan-cbow-continuous-bag-of-words"><strong>5. Word Embeddings dengan CBOW (Continuous Bag of Words)</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#perbandingan-hasil-tf-idf-vs-cbow"><strong>6. Perbandingan Hasil: TF-IDF vs CBOW</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perbedaan-pendekatan"><strong>üîç Perbedaan Pendekatan:</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output-yang-dihasilkan"><strong>üìä Output yang Dihasilkan:</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplikasi-praktis"><strong>üí° Aplikasi Praktis:</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#menghitung-dan-menyimpan-file-hasil-tf-idf"><strong>6. Menghitung dan Menyimpan File Hasil TF-IDF</strong></a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install requests beautifulsoup4 lxml
<span class="o">%</span><span class="k">pip</span> install openpyxl xlsxwriter

<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bs4</span><span class="w"> </span><span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: requests in c:\users\hp\appdata\local\programs\python\python311\lib\site-packages (2.32.5)
Requirement already satisfied: beautifulsoup4 in c:\users\hp\appdata\local\programs\python\python311\lib\site-packages (4.13.5)
Requirement already satisfied: lxml in c:\users\hp\appdata\local\programs\python\python311\lib\site-packages (6.0.1)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in c:\users\hp\appdata\local\programs\python\python311\lib\site-packages (from requests) (3.4.3)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in c:\users\hp\appdata\local\programs\python\python311\lib\site-packages (from requests) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in c:\users\hp\appdata\local\programs\python\python311\lib\site-packages (from requests) (2.2.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in c:\users\hp\appdata\local\programs\python\python311\lib\site-packages (from requests) (2025.8.3)
Requirement already satisfied: soupsieve&gt;1.2 in c:\users\hp\appdata\local\programs\python\python311\lib\site-packages (from beautifulsoup4) (2.7)
Requirement already satisfied: typing-extensions&gt;=4.0.0 in c:\users\hp\appdata\local\programs\python\python311\lib\site-packages (from beautifulsoup4) (4.14.1)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: openpyxl in c:\users\hp\appdata\local\programs\python\python311\lib\site-packages (3.1.5)
Requirement already satisfied: xlsxwriter in c:\users\hp\appdata\local\programs\python\python311\lib\site-packages (3.2.9)
Requirement already satisfied: et-xmlfile in c:\users\hp\appdata\local\programs\python\python311\lib\site-packages (from openpyxl) (2.0.0)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://pta.trunojoyo.ac.id/c_search/byprod&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_max_page</span><span class="p">(</span><span class="n">prodi_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mendapatkan jumlah halaman maksimal untuk prodi tertentu&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_URL</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">prodi_id</span><span class="si">}</span><span class="s2">/1&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        
        <span class="n">pagination</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;a[href*=&quot;byprod&quot;]&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pagination</span><span class="p">:</span>
            <span class="n">last_page</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">pagination</span><span class="p">:</span>
                <span class="n">href</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;/byprod/</span><span class="si">{</span><span class="n">prodi_id</span><span class="si">}</span><span class="s1">/&#39;</span> <span class="ow">in</span> <span class="n">href</span><span class="p">:</span>
                    <span class="n">page_match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">rf</span><span class="s1">&#39;/byprod/</span><span class="si">{</span><span class="n">prodi_id</span><span class="si">}</span><span class="s1">/(\d+)&#39;</span><span class="p">,</span> <span class="n">href</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">page_match</span><span class="p">:</span>
                        <span class="n">page_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">page_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                        <span class="n">last_page</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">last_page</span><span class="p">,</span> <span class="n">page_num</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">last_page</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>

<span class="k">def</span><span class="w"> </span><span class="nf">pta</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fungsi utama untuk scraping data PTA&quot;&quot;&quot;</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;judul&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;abstrak_id&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;abstrak_en&quot;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>
    
    <span class="n">prodi_id</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">prodi_name</span> <span class="o">=</span> <span class="s2">&quot;Manajemen&quot;</span>
    
    <span class="c1"># Get max pages</span>
    <span class="n">max_page</span> <span class="o">=</span> <span class="n">get_max_page</span><span class="p">(</span><span class="n">prodi_id</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_page</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_URL</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">prodi_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
            <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
            <span class="n">jurnals</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;li[data-cat=&quot;#luxury&quot;]&#39;</span><span class="p">)</span>
            
            <span class="c1"># Process setiap jurnal</span>
            <span class="k">for</span> <span class="n">jurnal</span> <span class="ow">in</span> <span class="n">jurnals</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">link_keluar</span> <span class="o">=</span> <span class="n">jurnal</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s1">&#39;a.gray.button&#39;</span><span class="p">)[</span><span class="s1">&#39;href&#39;</span><span class="p">]</span>
                    
                    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">link_keluar</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
                    <span class="n">soup1</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
                    <span class="n">isi</span> <span class="o">=</span> <span class="n">soup1</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s1">&#39;div#content_journal&#39;</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">isi</span><span class="p">:</span>
                        <span class="k">continue</span>
                    
                    <span class="c1"># Extract data</span>
                    <span class="n">judul</span> <span class="o">=</span> <span class="n">isi</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s1">&#39;a.title&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    
                    <span class="c1"># Extract abstrak</span>
                    <span class="n">paragraf</span> <span class="o">=</span> <span class="n">isi</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;p[align=&quot;justify&quot;]&#39;</span><span class="p">)</span>
                    <span class="n">abstrak_id</span> <span class="o">=</span> <span class="n">paragraf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paragraf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
                    <span class="n">abstrak_en</span> <span class="o">=</span> <span class="n">paragraf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">strip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paragraf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span>
                    
                    <span class="c1"># Clean abstrak Indonesia</span>
                    <span class="k">if</span> <span class="n">abstrak_id</span> <span class="o">!=</span> <span class="s2">&quot;N/A&quot;</span> <span class="ow">and</span> <span class="n">abstrak_id</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ABSTRAK&#39;</span><span class="p">):</span>
                        <span class="n">abstrak_id</span> <span class="o">=</span> <span class="n">abstrak_id</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    
                    <span class="c1"># Append data</span>
                    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;judul&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">judul</span><span class="p">)</span>
                    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;abstrak_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abstrak_id</span><span class="p">)</span>
                    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;abstrak_en&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abstrak_en</span><span class="p">)</span>
                    
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
                    
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">continue</span>
            
        <span class="k">except</span><span class="p">:</span>
            <span class="k">continue</span>
    
    <span class="c1"># Buat DataFrame</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    
    <span class="c1"># Summary</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìä Total data dikumpulkan: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Jalankan scraping</span>
<span class="n">result_df</span> <span class="o">=</span> <span class="n">pta</span><span class="p">()</span>

<span class="c1"># Ambil abstrak Indonesia untuk corpus</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="n">result_df</span><span class="p">[</span><span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;abstrak_id&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;N/A&#39;</span><span class="p">][</span><span class="s1">&#39;abstrak_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># Tampilkan dalam bentuk DataFrame (semua data)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">df_sample</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;No&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;Abstrak&#39;</span><span class="p">:</span> <span class="n">corpus</span>
<span class="p">})</span>

<span class="n">df_sample</span>
</pre></div>
</div>
</div>
</div>
<section id="pembersihan-teks">
<h1><strong>1. Pembersihan Teks</strong><a class="headerlink" href="#pembersihan-teks" title="Link to this heading">#</a></h1>
<p><strong>Pembersihan teks</strong> adalah tahap preprocessing untuk menormalkan data teks agar konsisten dan siap dianalisis. Proses ini meliputi: mengubah teks ke huruf kecil (lowercasing), menghapus angka, menghilangkan tanda baca, dan membersihkan spasi berlebih. Tujuannya adalah mengurangi variasi yang tidak perlu dan memfokuskan analisis pada konten tekstual yang bermakna.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pembersihan teks</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="k">def</span><span class="w"> </span><span class="nf">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="c1"># Ubah ke huruf kecil</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="c1"># Hapus angka</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="c1"># Hapus tanda baca</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^\w\s]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
    <span class="c1"># Hapus spasi berlebih</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">text</span>

<span class="c1"># Terapkan pembersihan teks</span>
<span class="n">cleaned_corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">clean_text</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">corpus</span><span class="p">]</span>

<span class="c1"># Tampilkan hasil pembersihan teks dalam format DataFrame</span>
<span class="n">comparison_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;abstrak_asli&#39;</span><span class="p">:</span> <span class="n">corpus</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span>
    <span class="s1">&#39;abstrak_bersih&#39;</span><span class="p">:</span> <span class="n">cleaned_corpus</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Hasil Pembersihan Teks:&quot;</span><span class="p">)</span>
<span class="n">comparison_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hasil Pembersihan Teks:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>abstrak_asli</th>
      <th>abstrak_bersih</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Satiyah, Pengaruh Faktor-faktor Pelatihan dan ...</td>
      <td>satiyah pengaruh faktorfaktor pelatihan dan pe...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tujuan penelitian ini adalah untuk mengetahui ...</td>
      <td>tujuan penelitian ini adalah untuk mengetahui ...</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>Aplikasi nyata pemanfaatan teknologi informasi...</td>
      <td>aplikasi nyata pemanfaatan teknologi informasi...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Penelitian ini menggunakan metode kuantitatif,...</td>
      <td>penelitian ini menggunakan metode kuantitatif ...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Aththaariq, Pengaruh Kompetensi Dosen Terhadap...</td>
      <td>aththaariq pengaruh kompetensi dosen terhadap ...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Haryono Arifin, Pengaruh Perilaku Konsumen Ter...</td>
      <td>haryono arifin pengaruh perilaku konsumen terh...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Dharma Abidin Syah,Kesimpulan: (1) Terdapat pe...</td>
      <td>dharma abidin syahkesimpulan terdapat pengaruh...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Tujuan penelitian ini adalah untuk mengidentif...</td>
      <td>tujuan penelitian ini adalah untuk mengidentif...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Hasil dari penelitian ini dari perhitungan Cre...</td>
      <td>hasil dari penelitian ini dari perhitungan cre...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="tokenisasi">
<h1><strong>2. Tokenisasi</strong><a class="headerlink" href="#tokenisasi" title="Link to this heading">#</a></h1>
<p><strong>Tokenisasi</strong> adalah proses memecah teks menjadi unit-unit yang lebih kecil seperti kata atau token. Pada tahap ini, setiap kalimat dalam abstrak dipecah menjadi kata-kata individual menggunakan <code class="docutils literal notranslate"><span class="pre">word_tokenize</span></code> dari NLTK. Contoh: kalimat ‚ÄúPenelitian ini menganalisis data‚Äù ‚Üí [‚ÄòPenelitian‚Äô, ‚Äòini‚Äô, ‚Äòmenganalisis‚Äô, ‚Äòdata‚Äô]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">nltk.tokenize</span><span class="w"> </span><span class="kn">import</span> <span class="n">word_tokenize</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">nltk</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;punkt_tab&#39;</span><span class="p">)</span>

<span class="c1"># Tokenisasi untuk PTA</span>
<span class="c1"># Buat DataFrame dari corpus yang sudah dibersihkan</span>
<span class="n">pta_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;abstrak_id_clean&#39;</span><span class="p">:</span> <span class="n">cleaned_corpus</span>
<span class="p">})</span>

<span class="n">pta_df</span><span class="p">[</span><span class="s2">&quot;abstrak_id_tokens&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pta_df</span><span class="p">[</span><span class="s2">&quot;abstrak_id_clean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">word_tokenize</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">PTA (abstrak_id_tokens):&quot;</span><span class="p">)</span>
<span class="n">pta_df</span><span class="p">[[</span><span class="s2">&quot;abstrak_id_clean&quot;</span><span class="p">,</span> <span class="s2">&quot;abstrak_id_tokens&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nltk_data] Downloading package punkt_tab to
[nltk_data]     C:\Users\hp\AppData\Roaming\nltk_data...
[nltk_data]   Package punkt_tab is already up-to-date!
[nltk_data]   Package punkt_tab is already up-to-date!
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PTA (abstrak_id_tokens):
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>abstrak_id_clean</th>
      <th>abstrak_id_tokens</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>satiyah pengaruh faktorfaktor pelatihan dan pe...</td>
      <td>[satiyah, pengaruh, faktorfaktor, pelatihan, d...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>tujuan penelitian ini adalah untuk mengetahui ...</td>
      <td>[tujuan, penelitian, ini, adalah, untuk, menge...</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td>[]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>aplikasi nyata pemanfaatan teknologi informasi...</td>
      <td>[aplikasi, nyata, pemanfaatan, teknologi, info...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>penelitian ini menggunakan metode kuantitatif ...</td>
      <td>[penelitian, ini, menggunakan, metode, kuantit...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>aththaariq pengaruh kompetensi dosen terhadap ...</td>
      <td>[aththaariq, pengaruh, kompetensi, dosen, terh...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>haryono arifin pengaruh perilaku konsumen terh...</td>
      <td>[haryono, arifin, pengaruh, perilaku, konsumen...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>dharma abidin syahkesimpulan terdapat pengaruh...</td>
      <td>[dharma, abidin, syahkesimpulan, terdapat, pen...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>tujuan penelitian ini adalah untuk mengidentif...</td>
      <td>[tujuan, penelitian, ini, adalah, untuk, mengi...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>hasil dari penelitian ini dari perhitungan cre...</td>
      <td>[hasil, dari, penelitian, ini, dari, perhitung...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="penghapusan-kata-umum-stop-words">
<h1><strong>3. Penghapusan Kata Umum (Stop Words)</strong><a class="headerlink" href="#penghapusan-kata-umum-stop-words" title="Link to this heading">#</a></h1>
<p><strong>Stop Words</strong> adalah kata-kata umum yang sering muncul dalam bahasa namun tidak memberikan makna signifikan untuk analisis teks, seperti ‚Äúdan‚Äù, ‚Äúatau‚Äù, ‚Äúdi‚Äù, ‚Äúke‚Äù, ‚Äúyang‚Äù. Penghapusan stopwords bertujuan untuk mengurangi noise dan fokus pada kata-kata yang lebih bermakna untuk analisis. NLTK menyediakan daftar stopwords bahasa Indonesia yang sudah siap pakai.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">nltk.corpus</span><span class="w"> </span><span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">nltk</span>

<span class="c1"># Download stopwords untuk bahasa Indonesia</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">)</span>

<span class="c1"># Stopwords untuk bahasa Indonesia</span>
<span class="n">stop_words_id</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;indonesian&#39;</span><span class="p">))</span>

<span class="c1"># Filter stopwords di PTA</span>
<span class="n">pta_df</span><span class="p">[</span><span class="s2">&quot;abstrak_id_filtered&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pta_df</span><span class="p">[</span><span class="s2">&quot;abstrak_id_tokens&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">tokens</span><span class="p">:</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop_words_id</span><span class="p">]</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">PTA (abstrak_id_filtered):&quot;</span><span class="p">)</span>
<span class="n">pta_df</span><span class="p">[[</span><span class="s2">&quot;abstrak_id_tokens&quot;</span><span class="p">,</span> <span class="s2">&quot;abstrak_id_filtered&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nltk_data] Downloading package stopwords to
[nltk_data]     C:\Users\hp\AppData\Roaming\nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PTA (abstrak_id_filtered):
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>abstrak_id_tokens</th>
      <th>abstrak_id_filtered</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[satiyah, pengaruh, faktorfaktor, pelatihan, d...</td>
      <td>[satiyah, pengaruh, faktorfaktor, pelatihan, p...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[tujuan, penelitian, ini, adalah, untuk, menge...</td>
      <td>[tujuan, penelitian, persepsi, brand, associat...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[]</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[aplikasi, nyata, pemanfaatan, teknologi, info...</td>
      <td>[aplikasi, nyata, pemanfaatan, teknologi, info...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[penelitian, ini, menggunakan, metode, kuantit...</td>
      <td>[penelitian, metode, kuantitatif, menekankan, ...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>[aththaariq, pengaruh, kompetensi, dosen, terh...</td>
      <td>[aththaariq, pengaruh, kompetensi, dosen, kine...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>[haryono, arifin, pengaruh, perilaku, konsumen...</td>
      <td>[haryono, arifin, pengaruh, perilaku, konsumen...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>[dharma, abidin, syahkesimpulan, terdapat, pen...</td>
      <td>[dharma, abidin, syahkesimpulan, pengaruh, sig...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>[tujuan, penelitian, ini, adalah, untuk, mengi...</td>
      <td>[tujuan, penelitian, mengidentifikasi, variabe...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>[hasil, dari, penelitian, ini, dari, perhitung...</td>
      <td>[hasil, penelitian, perhitungan, credit, risk,...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="stemming-dan-lematisasi">
<h1><strong>4. Stemming dan Lematisasi</strong><a class="headerlink" href="#stemming-dan-lematisasi" title="Link to this heading">#</a></h1>
<p><strong>Stemming</strong> adalah proses mengubah kata-kata menjadi bentuk dasar (root/stem) dengan menghilangkan imbuhan seperti awalan, akhiran, dan sisipan. Contoh: ‚Äúpenelitian‚Äù ‚Üí ‚Äúteliti‚Äù, ‚Äúmenganalisis‚Äù ‚Üí ‚Äúanalisis‚Äù. <strong>Lematisasi</strong> serupa dengan stemming namun menghasilkan kata dasar yang lebih bermakna secara linguistik. Pada kode ini menggunakan library Sastrawi untuk stemming bahasa Indonesia dan TF-IDF untuk mengukur kepentingan kata dalam dokumen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">Sastrawi</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Sastrawi.Stemmer.StemmerFactory</span><span class="w"> </span><span class="kn">import</span> <span class="n">StemmerFactory</span>
<span class="n">factory</span> <span class="o">=</span> <span class="n">StemmerFactory</span><span class="p">()</span>
<span class="n">stemmer</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">create_stemmer</span><span class="p">()</span>

<span class="c1"># Test stemming dengan satu dokumen</span>
<span class="n">input_stemm</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pta_df</span><span class="p">[</span><span class="s2">&quot;abstrak_id_filtered&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">hasil_stemm</span> <span class="o">=</span> <span class="n">stemmer</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">input_stemm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hasil_stemm</span><span class="p">)</span>

<span class="c1"># Stemming untuk semua dokumen</span>
<span class="n">hasil_stemm</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">pta_df</span><span class="p">[</span><span class="s2">&quot;abstrak_id_filtered&quot;</span><span class="p">]:</span>
    <span class="n">stemmed_doc</span> <span class="o">=</span> <span class="p">[</span><span class="n">stemmer</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">]</span>
    <span class="n">hasil_stemm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stemmed_doc</span><span class="p">)</span>

<span class="c1"># Konversi hasil stemming ke string untuk TF-IDF</span>
<span class="n">stemmed_texts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">hasil_stemm</span><span class="p">]</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_extraction.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">stemmed_texts</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>satiyah pengaruh faktorfaktor latih kembang produktivitas kerja dinas laut ikan bangkal bawah bimbing drahjsanugrahini irawatimm helm buyung auliasstsemmt upaya tingkat produktivitas kerja mudah salah usaha produktivitas tingkat terap program latih kembang sumber daya manusia sdm laksana instansi produktivitas capai tingkat mampu pegawai efektif efisien latih pengembnagan harap pegawai sesuai kebutuhankebutuhan sikap tingkah laku terampil tahu sesuai tuntut ubah latih kembang pegawai dukung cipta suasana kerja kondusif instansi produktivitas kerja tingkat tuju teliti pengaruh faktorfaktor latih kembang produktivitas kerja dinas laut ikan bangkal ukur menganalisa hubung variabel teliti dekat observasional analitik amat langsung responden sebar kuisioner analis teliti teliti populasi responden sampel olah spss versi analis metode statistik metode non probality sampling simple random sampling simpul teliti a faktorfaktor latih kembang beda individu pegawai x hubung analisis jabat x motivasi x partisipasi aktif x seleksi serta x seleksi instruktur x metode latih kembang x pengaruh simultan produktivitas kerja pegawai dinas laut ikan kabupaten bangkal bukti nilai koefisien determinasi ganda r r square fhitung ftabel b faktor hubung analisis jabat pengaruh parsial produktivitas kerja pegawai dinas laut ikan kabupaten bangkal uji hipotesis variabel motivasi x bukti nilai thitung seleksi serta x pengaruh dominan produktivitas kerja pegawai instansi dinas laut ikan bangkal kunci dinas laut ikan faktorfaktor latih kembang produktivitas kerja
  (0, 3835)	0.06410079410983066
  (0, 3127)	0.05506979793696032
  (0, 1234)	0.14148728361531826
  (0, 2320)	0.35125220511909655
  (0, 2025)	0.2310024290789113
  (0, 3380)	0.4237295114125377
  (0, 2052)	0.15395801965547096
  (0, 961)	0.25423770684752256
  (0, 2322)	0.33272649654294295
  (0, 1628)	0.3224038704618687
  (0, 433)	0.1297471048665307
  (0, 473)	0.01717152469532511
  (0, 570)	0.014613258757647558
  (0, 1030)	0.057560061635212295
  (0, 1794)	0.05101932916059392
  (0, 1521)	0.03514978048749194
  (0, 660)	0.03559921220338679
  (0, 375)	0.06410079410983066
  (0, 4636)	0.045738636603348766
  (0, 4486)	0.07697830041873661
  (0, 2741)	0.04643794034963594
  (0, 3787)	0.029775504198206976
  (0, 4645)	0.01669403924897024
  (0, 4418)	0.04285696914744371
  (0, 3399)	0.03559921220338679
  :	:
  (654, 3978)	0.060610706972008
  (654, 2974)	0.121221413944016
  (654, 1379)	0.055431470737939546
  (654, 1535)	0.05393497462982479
  (654, 1159)	0.26110655802086774
  (654, 2370)	0.04500648366260221
  (654, 4067)	0.05802108885497378
  (654, 715)	0.058502612126048806
  (654, 209)	0.055831597934352994
  (654, 1078)	0.041648917650643866
  (654, 791)	0.2580347664411713
  (654, 3322)	0.055831597934352994
  (654, 2277)	0.060610706972008
  (654, 899)	0.242442827888032
  (654, 3888)	0.051052488896697966
  (654, 4221)	0.2714650304890047
  (654, 650)	0.2580347664411713
  (654, 2686)	0.058502612126048806
  (654, 1118)	0.07679474858947376
  (654, 4019)	0.18357157584020387
  (654, 3500)	0.0698988013530705
  (654, 2486)	0.09072603158190014
  (654, 1754)	0.06694957982219636
  (654, 4204)	0.15358949717894751
  (654, 3650)	0.09072603158190014
  (0, 3835)	0.06410079410983066
  (0, 3127)	0.05506979793696032
  (0, 1234)	0.14148728361531826
  (0, 2320)	0.35125220511909655
  (0, 2025)	0.2310024290789113
  (0, 3380)	0.4237295114125377
  (0, 2052)	0.15395801965547096
  (0, 961)	0.25423770684752256
  (0, 2322)	0.33272649654294295
  (0, 1628)	0.3224038704618687
  (0, 433)	0.1297471048665307
  (0, 473)	0.01717152469532511
  (0, 570)	0.014613258757647558
  (0, 1030)	0.057560061635212295
  (0, 1794)	0.05101932916059392
  (0, 1521)	0.03514978048749194
  (0, 660)	0.03559921220338679
  (0, 375)	0.06410079410983066
  (0, 4636)	0.045738636603348766
  (0, 4486)	0.07697830041873661
  (0, 2741)	0.04643794034963594
  (0, 3787)	0.029775504198206976
  (0, 4645)	0.01669403924897024
  (0, 4418)	0.04285696914744371
  (0, 3399)	0.03559921220338679
  :	:
  (654, 3978)	0.060610706972008
  (654, 2974)	0.121221413944016
  (654, 1379)	0.055431470737939546
  (654, 1535)	0.05393497462982479
  (654, 1159)	0.26110655802086774
  (654, 2370)	0.04500648366260221
  (654, 4067)	0.05802108885497378
  (654, 715)	0.058502612126048806
  (654, 209)	0.055831597934352994
  (654, 1078)	0.041648917650643866
  (654, 791)	0.2580347664411713
  (654, 3322)	0.055831597934352994
  (654, 2277)	0.060610706972008
  (654, 899)	0.242442827888032
  (654, 3888)	0.051052488896697966
  (654, 4221)	0.2714650304890047
  (654, 650)	0.2580347664411713
  (654, 2686)	0.058502612126048806
  (654, 1118)	0.07679474858947376
  (654, 4019)	0.18357157584020387
  (654, 3500)	0.0698988013530705
  (654, 2486)	0.09072603158190014
  (654, 1754)	0.06694957982219636
  (654, 4204)	0.15358949717894751
  (654, 3650)	0.09072603158190014
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">nltk</span><span class="w"> </span><span class="kn">import</span> <span class="n">FreqDist</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Gabungkan semua kata dari hasil stemming</span>
<span class="n">all_words</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">hasil_stemm</span><span class="p">:</span>
    <span class="n">all_words</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

<span class="n">fdist</span> <span class="o">=</span> <span class="n">FreqDist</span><span class="p">(</span><span class="n">all_words</span><span class="p">)</span>

<span class="n">frequency_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">fdist</span><span class="o">.</span><span class="n">most_common</span><span class="p">(),</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Word&#39;</span><span class="p">,</span> <span class="s1">&#39;Frequency&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">frequency_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;Management_dataHasilPreprocessing.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;File disimpan sebagai Management_dataHasilPreprocessing.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>File disimpan sebagai Management_dataHasilPreprocessing.csv
</pre></div>
</div>
</div>
</div>
</section>
<section id="word-embeddings-dengan-cbow-continuous-bag-of-words">
<h1><strong>5. Word Embeddings dengan CBOW (Continuous Bag of Words)</strong><a class="headerlink" href="#word-embeddings-dengan-cbow-continuous-bag-of-words" title="Link to this heading">#</a></h1>
<p><strong>CBOW</strong> adalah salah satu arsitektur Word2Vec yang memprediksi kata target berdasarkan konteks di sekitarnya. Berbeda dengan TF-IDF yang menghasilkan sparse vectors, CBOW menghasilkan dense vectors yang dapat menangkap hubungan semantik antar kata. Model ini berguna untuk analisis similarity dan clustering dokumen berdasarkan makna kontekstual.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install dan konfigurasi libraries untuk CBOW dengan versi kompatibel</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

<span class="k">def</span><span class="w"> </span><span class="nf">install_package</span><span class="p">(</span><span class="n">package</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Install package dengan handling error&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">check_call</span><span class="p">([</span><span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;pip&quot;</span><span class="p">,</span> <span class="s2">&quot;install&quot;</span><span class="p">,</span> <span class="n">package</span><span class="p">])</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># Install packages dengan versi yang kompatibel</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üì¶ Installing compatible packages...&quot;</span><span class="p">)</span>

<span class="n">packages</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;numpy==1.24.4&quot;</span><span class="p">,</span>  <span class="c1"># Versi yang lebih kompatibel</span>
    <span class="s2">&quot;scipy==1.10.1&quot;</span><span class="p">,</span>   <span class="c1"># Versi yang lebih stabil</span>
    <span class="s2">&quot;gensim==4.3.0&quot;</span>    <span class="c1"># Versi gensim yang stabil</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">package</span> <span class="ow">in</span> <span class="n">packages</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Installing </span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">install_package</span><span class="p">(</span><span class="n">package</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚úÖ </span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2"> installed successfully&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚ö†Ô∏è Failed to install </span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">, trying alternative...&quot;</span><span class="p">)</span>

<span class="c1"># Import libraries dengan error handling yang lebih baik</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üîÑ Importing libraries...&quot;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Force reload modules jika sudah ada</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">importlib</span>
    
    <span class="c1"># Import dengan try-except individual</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ‚úÖ numpy imported&quot;</span><span class="p">)</span>
    
    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ‚úÖ pandas imported&quot;</span><span class="p">)</span>
    
    <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics.pairwise</span><span class="w"> </span><span class="kn">import</span> <span class="n">cosine_similarity</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ‚úÖ sklearn imported&quot;</span><span class="p">)</span>
    
    <span class="c1"># Import gensim dengan handling khusus</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">gensim.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Word2Vec</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ‚úÖ gensim Word2Vec imported&quot;</span><span class="p">)</span>
        <span class="n">gensim_available</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚ùå gensim import error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   üí° Trying alternative import method...&quot;</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Alternative import method</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">gensim</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">gensim</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span>
            <span class="n">Word2Vec</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Word2Vec</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   ‚úÖ gensim imported via alternative method&quot;</span><span class="p">)</span>
            <span class="n">gensim_available</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚ùå Alternative gensim import failed: </span><span class="si">{</span><span class="n">e2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">gensim_available</span> <span class="o">=</span> <span class="kc">False</span>
            
    <span class="k">if</span> <span class="n">gensim_available</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üéâ Semua libraries berhasil diimport!&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ö†Ô∏è Gensim tidak tersedia, akan skip analisis CBOW&quot;</span><span class="p">)</span>
        
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå Critical import error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üí° Silakan restart kernel dan coba lagi&quot;</span><span class="p">)</span>

<span class="c1"># Lanjutkan jika gensim berhasil diimport</span>
<span class="k">if</span> <span class="s1">&#39;gensim_available&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">gensim_available</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== ANALISIS WORD EMBEDDINGS DENGAN CBOW ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Siapkan data untuk Word2Vec (perlu dalam format list of sentences)</span>
    <span class="n">sentences</span> <span class="o">=</span> <span class="n">hasil_stemm</span>  <span class="c1"># hasil_stemm sudah berupa list of lists (sentences)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üìä Data untuk training CBOW:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Total dokumen: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sentences</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Rata-rata panjang dokumen: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sentences</span><span class="p">])</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kata&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Total unique words: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">word</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sentences</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">word</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sent</span><span class="p">]))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Training Word2Vec dengan arsitektur CBOW</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ü§ñ Training Word2Vec model dengan CBOW...&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">cbow_model</span> <span class="o">=</span> <span class="n">Word2Vec</span><span class="p">(</span>
            <span class="n">sentences</span><span class="o">=</span><span class="n">sentences</span><span class="p">,</span>
            <span class="n">vector_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>        <span class="c1"># Dimensi embedding (dense vector)</span>
            <span class="n">window</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>              <span class="c1"># Ukuran context window</span>
            <span class="n">min_count</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>           <span class="c1"># Minimum frekuensi kata untuk dimasukkan</span>
            <span class="n">sg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>                  <span class="c1"># sg=0 untuk CBOW, sg=1 untuk Skip-gram</span>
            <span class="n">workers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>             <span class="c1"># Jumlah thread untuk training</span>
            <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>            <span class="c1"># Jumlah iterasi training</span>
            <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>                <span class="c1"># Untuk reproducibility</span>
        <span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úÖ Model CBOW berhasil dilatih!&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Vocabulary size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="p">)</span><span class="si">}</span><span class="s2"> kata&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Vector dimensions: </span><span class="si">{</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">vector_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Training epochs: </span><span class="si">{</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">epochs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Analisis kata-kata terdekat</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üîç ANALISIS SEMANTIC SIMILARITY:&quot;</span><span class="p">)</span>

        <span class="c1"># Pilih beberapa kata kunci untuk analisis</span>
        <span class="n">sample_words</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vocab_words</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">key_to_index</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="c1"># Ambil kata-kata yang relevan dengan domain manajemen</span>
        <span class="n">target_keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;manaj&#39;</span><span class="p">,</span> <span class="s1">&#39;perusaha&#39;</span><span class="p">,</span> <span class="s1">&#39;kinerja&#39;</span><span class="p">,</span> <span class="s1">&#39;strategi&#39;</span><span class="p">,</span> <span class="s1">&#39;analisis&#39;</span><span class="p">,</span> <span class="s1">&#39;peneliti&#39;</span><span class="p">,</span> <span class="s1">&#39;hasil&#39;</span><span class="p">,</span> <span class="s1">&#39;faktor&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">target_keywords</span><span class="p">:</span>
            <span class="c1"># Cari kata yang mengandung keyword</span>
            <span class="n">matching_words</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">vocab_words</span> <span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">word</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">matching_words</span><span class="p">:</span>
                <span class="n">sample_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">matching_words</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># Ambil yang pertama</span>

        <span class="c1"># Tampilkan analisis similarity untuk beberapa kata</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sample_words</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>  <span class="c1"># Ambil 5 kata pertama</span>
            <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">similar_words</span> <span class="o">=</span> <span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">most_similar</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">topn</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìù Kata mirip dengan &#39;</span><span class="si">{</span><span class="n">word</span><span class="si">}</span><span class="s2">&#39;:&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">similar_word</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">similar_words</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      </span><span class="si">{</span><span class="n">similar_word</span><span class="si">:</span><span class="s2">15s</span><span class="si">}</span><span class="s2"> | Similarity: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Tidak bisa mencari kata mirip untuk &#39;</span><span class="si">{</span><span class="n">word</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">cbow_success</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚ùå Error training CBOW model: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üí° Model tidak dapat dilatih, akan skip analisis lanjutan&quot;</span><span class="p">)</span>
        <span class="n">cbow_success</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ö†Ô∏è GENSIM TIDAK TERSEDIA - SKIP ANALISIS CBOW&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analisis CBOW memerlukan library gensim yang tidak dapat diimport.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Silakan install ulang atau gunakan environment yang berbeda.&quot;</span><span class="p">)</span>
    <span class="n">cbow_success</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>üì¶ Installing compatible packages...
   Installing numpy==1.24.4...
   ‚úÖ numpy==1.24.4 installed successfully
   Installing scipy==1.10.1...
   ‚úÖ numpy==1.24.4 installed successfully
   Installing scipy==1.10.1...
   ‚úÖ scipy==1.10.1 installed successfully
   Installing gensim==4.3.0...
   ‚úÖ scipy==1.10.1 installed successfully
   Installing gensim==4.3.0...
   ‚úÖ gensim==4.3.0 installed successfully

üîÑ Importing libraries...
   ‚úÖ numpy imported
   ‚úÖ pandas imported
   ‚úÖ sklearn imported
   ‚úÖ gensim Word2Vec imported
üéâ Semua libraries berhasil diimport!
=== ANALISIS WORD EMBEDDINGS DENGAN CBOW ===

üìä Data untuk training CBOW:
   ‚Ä¢ Total dokumen: 655
   ‚Ä¢ Rata-rata panjang dokumen: 145.5 kata
   ‚Ä¢ Total unique words: 4872

ü§ñ Training Word2Vec model dengan CBOW...
   ‚úÖ gensim==4.3.0 installed successfully

üîÑ Importing libraries...
   ‚úÖ numpy imported
   ‚úÖ pandas imported
   ‚úÖ sklearn imported
   ‚úÖ gensim Word2Vec imported
üéâ Semua libraries berhasil diimport!
=== ANALISIS WORD EMBEDDINGS DENGAN CBOW ===

üìä Data untuk training CBOW:
   ‚Ä¢ Total dokumen: 655
   ‚Ä¢ Rata-rata panjang dokumen: 145.5 kata
   ‚Ä¢ Total unique words: 4872

ü§ñ Training Word2Vec model dengan CBOW...
‚úÖ Model CBOW berhasil dilatih!
   ‚Ä¢ Vocabulary size: 2818 kata
   ‚Ä¢ Vector dimensions: 100
   ‚Ä¢ Training epochs: 100

üîç ANALISIS SEMANTIC SIMILARITY:

üìù Kata mirip dengan &#39;manajemen&#39;:
      bersih          | Similarity: 0.4004
      hrsc            | Similarity: 0.3846
      utm             | Similarity: 0.3826
      bakat           | Similarity: 0.3597
      susun           | Similarity: 0.3271

üìù Kata mirip dengan &#39;perusahaanperusahaan&#39;:
      tawar           | Similarity: 0.5036
      sumbu           | Similarity: 0.5002
      usah            | Similarity: 0.4990
      ketat           | Similarity: 0.4988
      bawa            | Similarity: 0.4685

üìù Kata mirip dengan &#39;kualitaskinerja&#39;:
      hargavalue      | Similarity: 0.7456
      fungsional      | Similarity: 0.7179
      emosional       | Similarity: 0.5555
      money           | Similarity: 0.5520
      customer        | Similarity: 0.5359

üìù Kata mirip dengan &#39;strategi&#39;:
      relatif         | Similarity: 0.5747
      terap           | Similarity: 0.5548
      saing           | Similarity: 0.5305
      luas            | Similarity: 0.5191
      unggul          | Similarity: 0.5065

üìù Kata mirip dengan &#39;analisis&#39;:
      uji             | Similarity: 0.6569
      analisa         | Similarity: 0.5739
      regresi         | Similarity: 0.5685
      ganda           | Similarity: 0.5435
      olah            | Similarity: 0.5325

============================================================
‚úÖ Model CBOW berhasil dilatih!
   ‚Ä¢ Vocabulary size: 2818 kata
   ‚Ä¢ Vector dimensions: 100
   ‚Ä¢ Training epochs: 100

üîç ANALISIS SEMANTIC SIMILARITY:

üìù Kata mirip dengan &#39;manajemen&#39;:
      bersih          | Similarity: 0.4004
      hrsc            | Similarity: 0.3846
      utm             | Similarity: 0.3826
      bakat           | Similarity: 0.3597
      susun           | Similarity: 0.3271

üìù Kata mirip dengan &#39;perusahaanperusahaan&#39;:
      tawar           | Similarity: 0.5036
      sumbu           | Similarity: 0.5002
      usah            | Similarity: 0.4990
      ketat           | Similarity: 0.4988
      bawa            | Similarity: 0.4685

üìù Kata mirip dengan &#39;kualitaskinerja&#39;:
      hargavalue      | Similarity: 0.7456
      fungsional      | Similarity: 0.7179
      emosional       | Similarity: 0.5555
      money           | Similarity: 0.5520
      customer        | Similarity: 0.5359

üìù Kata mirip dengan &#39;strategi&#39;:
      relatif         | Similarity: 0.5747
      terap           | Similarity: 0.5548
      saing           | Similarity: 0.5305
      luas            | Similarity: 0.5191
      unggul          | Similarity: 0.5065

üìù Kata mirip dengan &#39;analisis&#39;:
      uji             | Similarity: 0.6569
      analisa         | Similarity: 0.5739
      regresi         | Similarity: 0.5685
      ganda           | Similarity: 0.5435
      olah            | Similarity: 0.5325

============================================================
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lanjutkan document embeddings jika CBOW berhasil</span>
<span class="k">if</span> <span class="s1">&#39;cbow_success&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">cbow_success</span> <span class="ow">and</span> <span class="s1">&#39;cbow_model&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
    <span class="c1"># Membuat Document Embeddings dengan rata-rata Word Vectors</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üî¢ PEMBUATAN DOCUMENT EMBEDDINGS&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_document_embedding</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Membuat embedding dokumen dengan rata-rata word vectors&quot;&quot;&quot;</span>
        <span class="n">vectors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">valid_words</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="p">:</span>
                <span class="n">vectors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="p">[</span><span class="n">word</span><span class="p">])</span>
                <span class="n">valid_words</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="k">if</span> <span class="n">vectors</span><span class="p">:</span>
            <span class="c1"># Rata-rata dari semua word vectors dalam dokumen</span>
            <span class="n">doc_embedding</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">doc_embedding</span><span class="p">,</span> <span class="n">valid_words</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Jika tidak ada kata yang valid, return zero vector</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">vector_size</span><span class="p">),</span> <span class="mi">0</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ö†Ô∏è SKIP DOCUMENT EMBEDDINGS - CBOW MODEL TIDAK TERSEDIA&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Document embeddings memerlukan model CBOW yang sudah dilatih.&quot;</span><span class="p">)</span>
    
<span class="k">if</span> <span class="s1">&#39;cbow_success&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">cbow_success</span> <span class="ow">and</span> <span class="s1">&#39;cbow_model&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>

    <span class="c1"># Buat embeddings untuk semua dokumen</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìã Membuat embeddings untuk </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sentences</span><span class="p">)</span><span class="si">}</span><span class="s2"> dokumen...&quot;</span><span class="p">)</span>

    <span class="n">document_embeddings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">valid_words_count</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">doc_info</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sentences</span><span class="p">):</span>
        <span class="n">embedding</span><span class="p">,</span> <span class="n">valid_count</span> <span class="o">=</span> <span class="n">create_document_embedding</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">cbow_model</span><span class="p">)</span>
        <span class="n">document_embeddings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">embedding</span><span class="p">)</span>
        <span class="n">valid_words_count</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valid_count</span><span class="p">)</span>
        
        <span class="c1"># Simpan informasi dokumen</span>
        <span class="n">original_text</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>  <span class="c1"># 10 kata pertama sebagai preview</span>
        <span class="n">doc_info</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;doc_id&#39;</span><span class="p">:</span> <span class="n">idx</span><span class="p">,</span>
            <span class="s1">&#39;preview&#39;</span><span class="p">:</span> <span class="n">original_text</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;...&#39;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
            <span class="s1">&#39;total_words&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">),</span>
            <span class="s1">&#39;valid_words&#39;</span><span class="p">:</span> <span class="n">valid_count</span><span class="p">,</span>
            <span class="s1">&#39;coverage&#39;</span><span class="p">:</span> <span class="n">valid_count</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="p">})</span>

    <span class="c1"># Convert ke numpy array</span>
    <span class="n">document_embeddings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">document_embeddings</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úÖ Document embeddings berhasil dibuat!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Shape: </span><span class="si">{</span><span class="n">document_embeddings</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Rata-rata kata valid per dokumen: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">valid_words_count</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Coverage rata-rata: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;coverage&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">doc_info</span><span class="p">])</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Hitung Document Similarity Matrix menggunakan Cosine Similarity</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üîó Menghitung similarity antar dokumen...&quot;</span><span class="p">)</span>
    <span class="n">doc_similarity_matrix</span> <span class="o">=</span> <span class="n">cosine_similarity</span><span class="p">(</span><span class="n">document_embeddings</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úÖ Similarity matrix berhasil dibuat!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Shape: </span><span class="si">{</span><span class="n">doc_similarity_matrix</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Rata-rata similarity: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Analisis dokumen paling mirip</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üéØ ANALISIS DOKUMEN PALING MIRIP:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">45</span><span class="p">)</span>

    <span class="c1"># Cari pasangan dokumen dengan similarity tertinggi</span>
    <span class="n">upper_triangle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">similarities</span> <span class="o">=</span> <span class="n">doc_similarity_matrix</span><span class="p">[</span><span class="n">upper_triangle</span><span class="p">]</span>
    <span class="n">sorted_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">similarities</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìä Top 5 pasangan dokumen paling mirip:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_indices</span><span class="p">))):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">sorted_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">doc_i</span><span class="p">,</span> <span class="n">doc_j</span> <span class="o">=</span> <span class="n">upper_triangle</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx</span><span class="p">],</span> <span class="n">upper_triangle</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">similarity_score</span> <span class="o">=</span> <span class="n">similarities</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">. Dokumen </span><span class="si">{</span><span class="n">doc_i</span><span class="si">}</span><span class="s2"> ‚Üî Dokumen </span><span class="si">{</span><span class="n">doc_j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   üìà Similarity Score: </span><span class="si">{</span><span class="n">similarity_score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   üìù Preview Doc </span><span class="si">{</span><span class="n">doc_i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">doc_info</span><span class="p">[</span><span class="n">doc_i</span><span class="p">][</span><span class="s1">&#39;preview&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   üìù Preview Doc </span><span class="si">{</span><span class="n">doc_j</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">doc_info</span><span class="p">[</span><span class="n">doc_j</span><span class="p">][</span><span class="s1">&#39;preview&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>üî¢ PEMBUATAN DOCUMENT EMBEDDINGS
==================================================

üìã Membuat embeddings untuk 655 dokumen...
‚úÖ Document embeddings berhasil dibuat!
   ‚Ä¢ Shape: (655, 100)
   ‚Ä¢ Rata-rata kata valid per dokumen: 142.4
   ‚Ä¢ Coverage rata-rata: 0.971

üîó Menghitung similarity antar dokumen...
‚úÖ Similarity matrix berhasil dibuat!
   ‚Ä¢ Shape: (655, 655)
   ‚Ä¢ Rata-rata similarity: 0.2804

üéØ ANALISIS DOKUMEN PALING MIRIP:
=============================================

üìä Top 5 pasangan dokumen paling mirip:

1. Dokumen 253 ‚Üî Dokumen 303
   üìà Similarity Score: 1.0000
   üìù Preview Doc 253: maulina hotim pengaruh pribadi mampu individu prestasi kerja karyawan dinas...
   üìù Preview Doc 303: maulina hotim pengaruh pribadi mampu individu prestasi kerja karyawan dinas...

2. Dokumen 331 ‚Üî Dokumen 647
   üìà Similarity Score: 0.9871
   üìù Preview Doc 331: teliti pt bank rakyat indonesia persero tbk cabang diponegoro surabaya...
   üìù Preview Doc 647: teliti judul pengaruh rotasi kerja motivasi kerja kerja karyawan puas...

3. Dokumen 376 ‚Üî Dokumen 483
   üìà Similarity Score: 0.9860
   üìù Preview Doc 376: tuju teliti pengaruh struktur modal long term debt to equity...
   üìù Preview Doc 483: tuju teliti pengaruh struktur modal long term debt to equity...

4. Dokumen 104 ‚Üî Dokumen 427
   üìà Similarity Score: 0.9851
   üìù Preview Doc 104: teliti tuju hitung rencana laba inap wisma koperasi analisa cost...
   üìù Preview Doc 427: teliti tuju hitung rencana laba hotel ningrat bangkal analisa cost...

5. Dokumen 230 ‚Üî Dokumen 349
   üìà Similarity Score: 0.9832
   üìù Preview Doc 230: tuju teliti ukur kerja uang bank bumn bni btn bri...
   üìù Preview Doc 349: dewi kartini nilai kerja uang rasio capital asset earnings liquidity...

============================================================
‚úÖ Document embeddings berhasil dibuat!
   ‚Ä¢ Shape: (655, 100)
   ‚Ä¢ Rata-rata kata valid per dokumen: 142.4
   ‚Ä¢ Coverage rata-rata: 0.971

üîó Menghitung similarity antar dokumen...
‚úÖ Similarity matrix berhasil dibuat!
   ‚Ä¢ Shape: (655, 655)
   ‚Ä¢ Rata-rata similarity: 0.2804

üéØ ANALISIS DOKUMEN PALING MIRIP:
=============================================

üìä Top 5 pasangan dokumen paling mirip:

1. Dokumen 253 ‚Üî Dokumen 303
   üìà Similarity Score: 1.0000
   üìù Preview Doc 253: maulina hotim pengaruh pribadi mampu individu prestasi kerja karyawan dinas...
   üìù Preview Doc 303: maulina hotim pengaruh pribadi mampu individu prestasi kerja karyawan dinas...

2. Dokumen 331 ‚Üî Dokumen 647
   üìà Similarity Score: 0.9871
   üìù Preview Doc 331: teliti pt bank rakyat indonesia persero tbk cabang diponegoro surabaya...
   üìù Preview Doc 647: teliti judul pengaruh rotasi kerja motivasi kerja kerja karyawan puas...

3. Dokumen 376 ‚Üî Dokumen 483
   üìà Similarity Score: 0.9860
   üìù Preview Doc 376: tuju teliti pengaruh struktur modal long term debt to equity...
   üìù Preview Doc 483: tuju teliti pengaruh struktur modal long term debt to equity...

4. Dokumen 104 ‚Üî Dokumen 427
   üìà Similarity Score: 0.9851
   üìù Preview Doc 104: teliti tuju hitung rencana laba inap wisma koperasi analisa cost...
   üìù Preview Doc 427: teliti tuju hitung rencana laba hotel ningrat bangkal analisa cost...

5. Dokumen 230 ‚Üî Dokumen 349
   üìà Similarity Score: 0.9832
   üìù Preview Doc 230: tuju teliti ukur kerja uang bank bumn bni btn bri...
   üìù Preview Doc 349: dewi kartini nilai kerja uang rasio capital asset earnings liquidity...

============================================================
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># EXPORT HASIL CBOW KE EXCEL DENGAN FORMAT PROFESIONAL</span>
<span class="k">if</span> <span class="s1">&#39;cbow_success&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">cbow_success</span> <span class="ow">and</span> <span class="s1">&#39;document_embeddings&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;üíæ EXPORT HASIL CBOW KE EXCEL MULTI-SHEET&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl</span><span class="w"> </span><span class="kn">import</span> <span class="n">Workbook</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl.styles</span><span class="w"> </span><span class="kn">import</span> <span class="n">Font</span><span class="p">,</span> <span class="n">PatternFill</span><span class="p">,</span> <span class="n">Border</span><span class="p">,</span> <span class="n">Side</span><span class="p">,</span> <span class="n">Alignment</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl.utils.dataframe</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataframe_to_rows</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl.formatting.rule</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColorScaleRule</span>
        
        <span class="c1"># Buat workbook baru untuk CBOW</span>
        <span class="n">wb_cbow</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
        
        <span class="c1"># Definisi styles yang sama seperti TF-IDF</span>
        <span class="n">header_font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;FFFFFF&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
        <span class="n">header_fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;2E8B57&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;2E8B57&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>  <span class="c1"># Sea Green untuk CBOW</span>
        <span class="n">header_alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">wrap_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">data_font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">data_alignment_left</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
        <span class="n">data_alignment_center</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
        <span class="n">data_alignment_right</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
        
        <span class="n">thin_border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span>
            <span class="n">left</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">),</span> <span class="n">right</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">),</span>
            <span class="n">top</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">),</span> <span class="n">bottom</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Sheet 1: Penjelasan Konsep CBOW</span>
        <span class="n">ws1</span> <span class="o">=</span> <span class="n">wb_cbow</span><span class="o">.</span><span class="n">active</span>
        <span class="n">ws1</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Penjelasan_CBOW&quot;</span>
        
        <span class="n">penjelasan_cbow</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="s1">&#39;Aspek&#39;</span><span class="p">,</span> <span class="s1">&#39;CBOW (Continuous Bag of Words)&#39;</span><span class="p">,</span> <span class="s1">&#39;Penjelasan Detail&#39;</span><span class="p">,</span> <span class="s1">&#39;Contoh Aplikasi&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Definisi&#39;</span><span class="p">,</span> <span class="s1">&#39;Neural network yang memprediksi kata target dari konteks&#39;</span><span class="p">,</span> <span class="s1">&#39;Menggunakan kata-kata di sekitar untuk memprediksi kata tengah&#39;</span><span class="p">,</span> <span class="s1">&#39;Prediksi kata hilang dalam kalimat&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Arsitektur&#39;</span><span class="p">,</span> <span class="s1">&#39;Input: context words ‚Üí Hidden layer ‚Üí Output: target word&#39;</span><span class="p">,</span> <span class="s1">&#39;Rata-rata word vectors sebagai input ke hidden layer&#39;</span><span class="p">,</span> <span class="s1">&#39;Context: [penelitian, ini, tentang] ‚Üí Target: menganalisis&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Vector Output&#39;</span><span class="p">,</span> <span class="s1">&#39;Dense vectors (100 dimensi)&#39;</span><span class="p">,</span> <span class="s1">&#39;Representasi padat yang menangkap semantic similarity&#39;</span><span class="p">,</span> <span class="s1">&#39;Kata &quot;analisis&quot; dan &quot;penelitian&quot; memiliki vector yang mirip&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Training Process&#39;</span><span class="p">,</span> <span class="s1">&#39;Sliding window melewati corpus&#39;</span><span class="p">,</span> <span class="s1">&#39;Window bergeser untuk create training pairs&#39;</span><span class="p">,</span> <span class="s1">&#39;Window size=5: ambil 2 kata kiri-kanan sebagai context&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Perbedaan dengan TF-IDF&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Representasi&#39;</span><span class="p">,</span> <span class="s1">&#39;Dense vectors (padat)&#39;</span><span class="p">,</span> <span class="s1">&#39;TF-IDF: Sparse vectors (jarang)&#39;</span><span class="p">,</span> <span class="s1">&#39;CBOW: 100 dimensi, TF-IDF: 6475 dimensi&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Basis Perhitungan&#39;</span><span class="p">,</span> <span class="s1">&#39;Semantic context&#39;</span><span class="p">,</span> <span class="s1">&#39;TF-IDF: Statistical frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;CBOW: makna, TF-IDF: frekuensi&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Similarity Measure&#39;</span><span class="p">,</span> <span class="s1">&#39;Cosine similarity antar dense vectors&#39;</span><span class="p">,</span> <span class="s1">&#39;TF-IDF: Dot product atau cosine&#39;</span><span class="p">,</span> <span class="s1">&#39;CBOW menangkap hubungan semantic lebih baik&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Interpretasi&#39;</span><span class="p">,</span> <span class="s1">&#39;Semantic relationships&#39;</span><span class="p">,</span> <span class="s1">&#39;TF-IDF: Term importance&#39;</span><span class="p">,</span> <span class="s1">&#39;CBOW: kata mirip secara makna&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Parameter Model CBOW&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Vector Size&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">vector_size</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Dimensi embedding untuk setiap kata&#39;</span><span class="p">,</span> <span class="s1">&#39;Lebih tinggi = representasi lebih detail&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Window Size&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">window</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Jumlah kata konteks kiri-kanan&#39;</span><span class="p">,</span> <span class="s1">&#39;Window=5 berarti 5 kata sebelum + 5 setelah&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Min Count&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">min_count</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Frekuensi minimum kata untuk dimasukkan&#39;</span><span class="p">,</span> <span class="s1">&#39;Kata &lt; 2x diabaikan untuk mengurangi noise&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Training Epochs&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">epochs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Jumlah iterasi training&#39;</span><span class="p">,</span> <span class="s1">&#39;Lebih banyak epoch = learning lebih dalam&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Total Vocabulary&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Ukuran kosakata model&#39;</span><span class="p">,</span> <span class="s1">&#39;Kata-kata yang dipelajari oleh model&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Statistik Dataset&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Total Dokumen&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sentences</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Jumlah abstrak yang dianalisis&#39;</span><span class="p">,</span> <span class="s1">&#39;Corpus penelitian manajemen&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Rata-rata Panjang Dokumen&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sentences</span><span class="p">])</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> kata&#39;</span><span class="p">,</span> <span class="s1">&#39;Panjang dokumen setelah preprocessing&#39;</span><span class="p">,</span> <span class="s1">&#39;Termasuk stemming dan stopword removal&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Coverage Rata-rata&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;coverage&quot;</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">doc_info</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Persentase kata yang dikenali model&#39;</span><span class="p">,</span> <span class="s1">&#39;Kata yang ada di vocabulary model&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Similarity Rata-rata&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Rata-rata kesamaan antar dokumen&#39;</span><span class="p">,</span> <span class="s1">&#39;Berbasis semantic similarity&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Max Similarity&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;Similarity tertinggi antar dokumen&#39;</span><span class="p">,</span> <span class="s1">&#39;Dokumen paling mirip secara semantic&#39;</span><span class="p">]</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">penjelasan_cbow</span><span class="p">:</span>
            <span class="n">ws1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        
        <span class="c1"># Format sheet penjelasan CBOW</span>
        <span class="k">for</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ws1</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">penjelasan_cbow</span><span class="p">)),</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="mi">7</span> <span class="ow">or</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="mi">13</span> <span class="ow">or</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="mi">19</span><span class="p">:</span>  <span class="c1"># Headers</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;FFFFFF&quot;</span><span class="p">)</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;2E8B57&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;2E8B57&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">]:</span>  <span class="c1"># Empty rows</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
                
                <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">wrap_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
        
        <span class="c1"># Set column widths</span>
        <span class="n">ws1</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">25</span>
        <span class="n">ws1</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">35</span>
        <span class="n">ws1</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">45</span>
        <span class="n">ws1</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">35</span>
        
        <span class="c1"># Sheet 2: Training Details</span>
        <span class="n">ws2</span> <span class="o">=</span> <span class="n">wb_cbow</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Detail_Training&quot;</span><span class="p">)</span>
        
        <span class="c1"># Buat data training details</span>
        <span class="n">training_details</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Ambil sample dari vocabulary untuk menunjukkan word vectors</span>
        <span class="n">sample_vocab</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">key_to_index</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">30</span><span class="p">]</span>  <span class="c1"># Top 30 kata</span>
        
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sample_vocab</span><span class="p">:</span>
            <span class="n">word_vector</span> <span class="o">=</span> <span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="p">[</span><span class="n">word</span><span class="p">]</span>
            <span class="n">frequency</span> <span class="o">=</span> <span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">get_vecattr</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">)</span>
            <span class="n">vector_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">word_vector</span><span class="p">)</span>
            
            <span class="c1"># Cari kata-kata paling mirip</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">similar_words</span> <span class="o">=</span> <span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">most_similar</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">topn</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">top_similar</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">similar_words</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">top_similar</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
            
            <span class="n">training_details</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Kata&#39;</span><span class="p">:</span> <span class="n">word</span><span class="p">,</span>
                <span class="s1">&#39;Frekuensi&#39;</span><span class="p">:</span> <span class="n">frequency</span><span class="p">,</span>
                <span class="s1">&#39;Vector_Norm&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">vector_norm</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s1">&#39;Kata_Mirip_Top3&#39;</span><span class="p">:</span> <span class="n">top_similar</span><span class="p">,</span>
                <span class="s1">&#39;Dimensi_1&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">word_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s1">&#39;Dimensi_2&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">word_vector</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s1">&#39;Dimensi_3&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">word_vector</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s1">&#39;Dimensi_4&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">word_vector</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s1">&#39;Dimensi_5&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">word_vector</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
            <span class="p">})</span>
        
        <span class="n">training_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">training_details</span><span class="p">)</span>
        
        <span class="c1"># Tulis training data</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">dataframe_to_rows</span><span class="p">(</span><span class="n">training_df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">ws2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        
        <span class="c1"># Format header sheet 2</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws2</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">header_font</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">header_fill</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">header_alignment</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
        
        <span class="c1"># Set column widths dan alignment</span>
        <span class="n">ws2_widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
        <span class="n">ws2_alignments</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_alignment_left</span><span class="p">,</span> <span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span>
                         <span class="n">data_alignment_left</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span> 
                         <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ws2_widths</span><span class="p">,</span> <span class="n">ws2_alignments</span><span class="p">)):</span>
            <span class="n">col_letter</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">65</span> <span class="o">+</span> <span class="n">idx</span><span class="p">)</span>
            <span class="n">ws2</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">col_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
            
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws2</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">data_font</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">alignment</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span>  <span class="c1"># Frequency</span>
                        <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
                    <span class="k">elif</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>  <span class="c1"># Vector values</span>
                        <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0.0000&#39;</span>
        
        <span class="n">ws2</span><span class="o">.</span><span class="n">freeze_panes</span> <span class="o">=</span> <span class="s2">&quot;A2&quot;</span>
        <span class="n">ws2</span><span class="o">.</span><span class="n">auto_filter</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">ws2</span><span class="o">.</span><span class="n">dimensions</span>
        <span class="n">ws2</span><span class="o">.</span><span class="n">row_dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">30</span>
        
        <span class="c1"># Sheet 3: Document Similarity Analysis</span>
        <span class="n">ws3</span> <span class="o">=</span> <span class="n">wb_cbow</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Analisis_Similarity&quot;</span><span class="p">)</span>
        
        <span class="c1"># Buat data untuk top similar document pairs</span>
        <span class="n">similar_pairs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_indices</span><span class="p">))):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">sorted_indices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">doc_i</span><span class="p">,</span> <span class="n">doc_j</span> <span class="o">=</span> <span class="n">upper_triangle</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx</span><span class="p">],</span> <span class="n">upper_triangle</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
            <span class="n">similarity_score</span> <span class="o">=</span> <span class="n">similarities</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            
            <span class="n">similar_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Ranking&#39;</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;ID_Dokumen_1&#39;</span><span class="p">:</span> <span class="n">doc_i</span><span class="p">,</span>
                <span class="s1">&#39;ID_Dokumen_2&#39;</span><span class="p">:</span> <span class="n">doc_j</span><span class="p">,</span>
                <span class="s1">&#39;Skor_Similarity&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">similarity_score</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                <span class="s1">&#39;Preview_Dok_1&#39;</span><span class="p">:</span> <span class="n">doc_info</span><span class="p">[</span><span class="n">doc_i</span><span class="p">][</span><span class="s1">&#39;preview&#39;</span><span class="p">][:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
                <span class="s1">&#39;Preview_Dok_2&#39;</span><span class="p">:</span> <span class="n">doc_info</span><span class="p">[</span><span class="n">doc_j</span><span class="p">][</span><span class="s1">&#39;preview&#39;</span><span class="p">][:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
                <span class="s1">&#39;Panjang_Dok_1&#39;</span><span class="p">:</span> <span class="n">doc_info</span><span class="p">[</span><span class="n">doc_i</span><span class="p">][</span><span class="s1">&#39;total_words&#39;</span><span class="p">],</span>
                <span class="s1">&#39;Panjang_Dok_2&#39;</span><span class="p">:</span> <span class="n">doc_info</span><span class="p">[</span><span class="n">doc_j</span><span class="p">][</span><span class="s1">&#39;total_words&#39;</span><span class="p">],</span>
                <span class="s1">&#39;Coverage_1&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">doc_info</span><span class="p">[</span><span class="n">doc_i</span><span class="p">][</span><span class="s1">&#39;coverage&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s1">&#39;Coverage_2&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">doc_info</span><span class="p">[</span><span class="n">doc_j</span><span class="p">][</span><span class="s1">&#39;coverage&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s1">&#39;Kategori_Similarity&#39;</span><span class="p">:</span> <span class="s1">&#39;Sangat Tinggi&#39;</span> <span class="k">if</span> <span class="n">similarity_score</span> <span class="o">&gt;</span> <span class="mf">0.8</span> <span class="k">else</span> <span class="s1">&#39;Tinggi&#39;</span> <span class="k">if</span> <span class="n">similarity_score</span> <span class="o">&gt;</span> <span class="mf">0.6</span> <span class="k">else</span> <span class="s1">&#39;Sedang&#39;</span> <span class="k">if</span> <span class="n">similarity_score</span> <span class="o">&gt;</span> <span class="mf">0.4</span> <span class="k">else</span> <span class="s1">&#39;Rendah&#39;</span>
            <span class="p">})</span>
        
        <span class="n">similarity_pairs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">similar_pairs</span><span class="p">)</span>
        
        <span class="c1"># Tulis similarity data</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">dataframe_to_rows</span><span class="p">(</span><span class="n">similarity_pairs_df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">ws3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        
        <span class="c1"># Format header sheet 3</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws3</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">header_font</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">header_fill</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">header_alignment</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
        
        <span class="c1"># Set column widths</span>
        <span class="n">ws3_widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
        <span class="n">ws3_alignments</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_center</span><span class="p">,</span>
                         <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_left</span><span class="p">,</span> <span class="n">data_alignment_left</span><span class="p">,</span>
                         <span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span> 
                         <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_center</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ws3_widths</span><span class="p">,</span> <span class="n">ws3_alignments</span><span class="p">)):</span>
            <span class="n">col_letter</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">65</span> <span class="o">+</span> <span class="n">idx</span><span class="p">)</span>
            <span class="n">ws3</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">col_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
            
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws3</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">data_font</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">alignment</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]:</span>  <span class="c1"># Similarity and coverage scores</span>
                        <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0.0000&#39;</span>
                    <span class="k">elif</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]:</span>  <span class="c1"># Document lengths</span>
                        <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
        
        <span class="c1"># Conditional formatting untuk similarity score</span>
        <span class="n">ws3</span><span class="o">.</span><span class="n">conditional_formatting</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;D2:D</span><span class="si">{</span><span class="n">ws3</span><span class="o">.</span><span class="n">max_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
                                      <span class="n">ColorScaleRule</span><span class="p">(</span><span class="n">start_type</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">start_color</span><span class="o">=</span><span class="s1">&#39;FFFFFF&#39;</span><span class="p">,</span>
                                                   <span class="n">mid_type</span><span class="o">=</span><span class="s1">&#39;percentile&#39;</span><span class="p">,</span> <span class="n">mid_value</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">mid_color</span><span class="o">=</span><span class="s1">&#39;98FB98&#39;</span><span class="p">,</span>
                                                   <span class="n">end_type</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s1">&#39;228B22&#39;</span><span class="p">))</span>
        
        <span class="n">ws3</span><span class="o">.</span><span class="n">freeze_panes</span> <span class="o">=</span> <span class="s2">&quot;A2&quot;</span>
        <span class="n">ws3</span><span class="o">.</span><span class="n">auto_filter</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">ws3</span><span class="o">.</span><span class="n">dimensions</span>
        <span class="n">ws3</span><span class="o">.</span><span class="n">row_dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">30</span>
        
        <span class="c1"># Sheet 4: Document Embeddings Summary  </span>
        <span class="n">ws4</span> <span class="o">=</span> <span class="n">wb_cbow</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Ringkasan_Embeddings&quot;</span><span class="p">)</span>
        
        <span class="c1"># Buat summary data untuk dokumen embeddings</span>
        <span class="n">doc_summary</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">doc_info</span><span class="p">[:</span><span class="mi">100</span><span class="p">]):</span>  <span class="c1"># Top 100 dokumen</span>
            <span class="n">embedding</span> <span class="o">=</span> <span class="n">document_embeddings</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            
            <span class="n">doc_summary</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;ID_Dokumen&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;doc_id&#39;</span><span class="p">],</span>
                <span class="s1">&#39;Preview_Dokumen&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;preview&#39;</span><span class="p">],</span>
                <span class="s1">&#39;Total_Kata&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;total_words&#39;</span><span class="p">],</span>
                <span class="s1">&#39;Kata_Valid&#39;</span><span class="p">:</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;valid_words&#39;</span><span class="p">],</span> 
                <span class="s1">&#39;Coverage&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;coverage&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s1">&#39;Embedding_Norm&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">embedding</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s1">&#39;Rata_Embedding&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">embedding</span><span class="p">),</span> <span class="mi">6</span><span class="p">),</span>
                <span class="s1">&#39;Std_Embedding&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">embedding</span><span class="p">),</span> <span class="mi">6</span><span class="p">),</span>
                <span class="s1">&#39;Min_Embedding&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">embedding</span><span class="p">),</span> <span class="mi">6</span><span class="p">),</span>
                <span class="s1">&#39;Max_Embedding&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">embedding</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
            <span class="p">})</span>
        
        <span class="n">doc_summary_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">doc_summary</span><span class="p">)</span>
        
        <span class="c1"># Tulis document summary data</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">dataframe_to_rows</span><span class="p">(</span><span class="n">doc_summary_df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">ws4</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        
        <span class="c1"># Format header sheet 4</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws4</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">header_font</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">header_fill</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">header_alignment</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
        
        <span class="c1"># Set column widths</span>
        <span class="n">ws4_widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
        <span class="n">ws4_alignments</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_left</span><span class="p">,</span> <span class="n">data_alignment_center</span><span class="p">,</span>
                         <span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span>
                         <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ws4_widths</span><span class="p">,</span> <span class="n">ws4_alignments</span><span class="p">)):</span>
            <span class="n">col_letter</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">65</span> <span class="o">+</span> <span class="n">idx</span><span class="p">)</span>
            <span class="n">ws4</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">col_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
            
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws4</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">data_font</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">alignment</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>  <span class="c1"># Word counts</span>
                        <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
                    <span class="k">elif</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]:</span>  <span class="c1"># Decimal values</span>
                        <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>  <span class="c1"># Coverage</span>
                            <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0.0000&#39;</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Other metrics</span>
                            <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0.000000&#39;</span>
        
        <span class="c1"># Conditional formatting untuk coverage</span>
        <span class="n">ws4</span><span class="o">.</span><span class="n">conditional_formatting</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;E2:E</span><span class="si">{</span><span class="n">ws4</span><span class="o">.</span><span class="n">max_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
                                      <span class="n">ColorScaleRule</span><span class="p">(</span><span class="n">start_type</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">start_color</span><span class="o">=</span><span class="s1">&#39;FFB6C1&#39;</span><span class="p">,</span>
                                                   <span class="n">end_type</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s1">&#39;90EE90&#39;</span><span class="p">))</span>
        
        <span class="n">ws4</span><span class="o">.</span><span class="n">freeze_panes</span> <span class="o">=</span> <span class="s2">&quot;A2&quot;</span>
        <span class="n">ws4</span><span class="o">.</span><span class="n">auto_filter</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">ws4</span><span class="o">.</span><span class="n">dimensions</span>
        <span class="n">ws4</span><span class="o">.</span><span class="n">row_dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">30</span>
        
        <span class="c1"># Sheet 5: Model Statistics dan Comparison</span>
        <span class="n">ws5</span> <span class="o">=</span> <span class="n">wb_cbow</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Statistik_Model&quot;</span><span class="p">)</span>
        
        <span class="c1"># Buat comprehensive model statistics</span>
        <span class="n">model_statistics</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">[</span><span class="s1">&#39;Metrik Model&#39;</span><span class="p">,</span> <span class="s1">&#39;Nilai&#39;</span><span class="p">,</span> <span class="s1">&#39;Deskripsi&#39;</span><span class="p">,</span> <span class="s1">&#39;Interpretasi&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Parameter Arsitektur&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Vector Dimensions&#39;</span><span class="p">,</span> <span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">vector_size</span><span class="p">,</span> <span class="s1">&#39;Ukuran embedding untuk setiap kata&#39;</span><span class="p">,</span> <span class="s1">&#39;Lebih tinggi = representasi lebih kaya&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Vocabulary Size&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="p">),</span> <span class="s1">&#39;Jumlah kata unik yang dipelajari&#39;</span><span class="p">,</span> <span class="s1">&#39;Ukuran kosakata model&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Window Size&#39;</span><span class="p">,</span> <span class="n">cbow_model</span><span class="o">.</span><span class="n">window</span><span class="p">,</span> <span class="s1">&#39;Jumlah kata konteks kiri-kanan&#39;</span><span class="p">,</span> <span class="s1">&#39;Context window untuk prediksi&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Min Count Threshold&#39;</span><span class="p">,</span> <span class="n">cbow_model</span><span class="o">.</span><span class="n">min_count</span><span class="p">,</span> <span class="s1">&#39;Frekuensi minimum kata&#39;</span><span class="p">,</span> <span class="s1">&#39;Filter noise dan kata jarang&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Training Epochs&#39;</span><span class="p">,</span> <span class="n">cbow_model</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span> <span class="s1">&#39;Jumlah iterasi pelatihan&#39;</span><span class="p">,</span> <span class="s1">&#39;Tingkat pembelajaran model&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Statistik Dataset&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Total Documents&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sentences</span><span class="p">),</span> <span class="s1">&#39;Jumlah dokumen dalam corpus&#39;</span><span class="p">,</span> <span class="s1">&#39;Ukuran dataset training&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Average Doc Length&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">sent</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sentences</span><span class="p">])</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;Rata-rata panjang dokumen&#39;</span><span class="p">,</span> <span class="s1">&#39;Kata per dokumen setelah preprocessing&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Total Unique Words&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">word</span> <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">sentences</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">sent</span><span class="p">])),</span> <span class="s1">&#39;Kata unik dalam corpus&#39;</span><span class="p">,</span> <span class="s1">&#39;Kekayaan vocabulary corpus&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Average Valid Words/Doc&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">valid_words_count</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;Kata valid rata-rata per dokumen&#39;</span><span class="p">,</span> <span class="s1">&#39;Kata yang dikenali model&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Average Coverage&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;coverage&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">doc_info</span><span class="p">])</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;Persentase kata yang dikenali&#39;</span><span class="p">,</span> <span class="s1">&#39;Tingkat coverage model terhadap corpus&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span> 
            <span class="p">[</span><span class="s1">&#39;Analisis Similarity&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Average Similarity&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;Rata-rata similarity antar dokumen&#39;</span><span class="p">,</span> <span class="s1">&#39;Tingkat kesamaan semantic corpus&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Max Similarity&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;Similarity tertinggi&#39;</span><span class="p">,</span> <span class="s1">&#39;Dokumen paling mirip&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Min Similarity&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;Similarity terendah&#39;</span><span class="p">,</span> <span class="s1">&#39;Dokumen paling berbeda&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Std Similarity&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;Standar deviasi similarity&#39;</span><span class="p">,</span> <span class="s1">&#39;Variasi kesamaan antar dokumen&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Perbandingan dengan TF-IDF&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Vector Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Dense (padat)&#39;</span><span class="p">,</span> <span class="s1">&#39;TF-IDF: Sparse (jarang)&#39;</span><span class="p">,</span> <span class="s1">&#39;CBOW lebih compact&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Dimensionality&#39;</span><span class="p">,</span> <span class="s1">&#39;100 dimensi&#39;</span><span class="p">,</span> <span class="s1">&#39;TF-IDF: ~6475 dimensi&#39;</span><span class="p">,</span> <span class="s1">&#39;CBOW lebih efisien storage&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Semantic Capture&#39;</span><span class="p">,</span> <span class="s1">&#39;Ya (context-based)&#39;</span><span class="p">,</span> <span class="s1">&#39;TF-IDF: Tidak (frequency-based)&#39;</span><span class="p">,</span> <span class="s1">&#39;CBOW menangkap makna&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Interpretability&#39;</span><span class="p">,</span> <span class="s1">&#39;Similarity semantic&#39;</span><span class="p">,</span> <span class="s1">&#39;TF-IDF: Term importance&#39;</span><span class="p">,</span> <span class="s1">&#39;Berbeda tujuan analisis&#39;</span><span class="p">],</span>
            <span class="p">[</span><span class="s1">&#39;Computational Cost&#39;</span><span class="p">,</span> <span class="s1">&#39;Training: Tinggi, Inference: Rendah&#39;</span><span class="p">,</span> <span class="s1">&#39;TF-IDF: Training: Rendah, Inference: Sedang&#39;</span><span class="p">,</span> <span class="s1">&#39;Trade-off waktu vs kualitas&#39;</span><span class="p">]</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">model_statistics</span><span class="p">:</span>
            <span class="n">ws5</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        
        <span class="c1"># Format sheet statistics</span>
        <span class="k">for</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ws5</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">model_statistics</span><span class="p">)),</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">]:</span>  <span class="c1"># Main headers</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;FFFFFF&quot;</span><span class="p">)</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;2E8B57&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;2E8B57&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">]:</span>  <span class="c1"># Empty rows</span>
                    <span class="k">continue</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
                
                <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">wrap_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
        
        <span class="c1"># Set column widths untuk statistics sheet</span>
        <span class="n">ws5</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">25</span>
        <span class="n">ws5</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="n">ws5</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">35</span>
        <span class="n">ws5</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">40</span>
        
        <span class="c1"># Simpan Excel file untuk CBOW</span>
        <span class="n">wb_cbow</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;CBOW_Analysis_Formatted.xlsx&#39;</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ Excel CBOW berhasil dibuat dengan 5 sheet komprehensif:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   üìä CBOW_Analysis_Formatted.xlsx - Analisis lengkap CBOW&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ‚Ä¢ Sheet 1: Penjelasan_CBOW - Konsep dan teori CBOW vs TF-IDF&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ‚Ä¢ Sheet 2: Detail_Training - Sample word vectors dan similarity&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ‚Ä¢ Sheet 3: Analisis_Similarity - Top pasangan dokumen mirip&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ‚Ä¢ Sheet 4: Ringkasan_Embeddings - Summary document embeddings&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ‚Ä¢ Sheet 5: Statistik_Model - Comprehensive model statistics&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìà CBOW Analysis Summary:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Total documents analyzed: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">doc_info</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Vocabulary size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Vector dimensions: </span><span class="si">{</span><span class="n">cbow_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">vector_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Average document similarity: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Top document similarity: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)])</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="n">cbow_excel_created</span> <span class="o">=</span> <span class="kc">True</span>
        
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ö†Ô∏è openpyxl not available - creating CSV files instead:&quot;</span><span class="p">)</span>
        
        <span class="c1"># Fallback ke CSV jika openpyxl tidak tersedia</span>
        <span class="n">doc_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">doc_info</span><span class="p">)</span>
        <span class="n">doc_df</span><span class="p">[</span><span class="s1">&#39;embedding_vector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">emb</span><span class="p">)</span> <span class="k">for</span> <span class="n">emb</span> <span class="ow">in</span> <span class="n">document_embeddings</span><span class="p">]</span>
        <span class="n">doc_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;CBOW_Document_Info.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">)</span>
        
        <span class="n">similarity_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">doc_similarity_matrix</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Doc_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">))],</span>
            <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Doc_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc_similarity_matrix</span><span class="p">))]</span>
        <span class="p">)</span>
        <span class="n">similarity_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;CBOW_Document_Similarity_Matrix.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   üìÑ CBOW_Document_Info.csv - Document information with embeddings&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   üìÑ CBOW_Document_Similarity_Matrix.csv - Similarity matrix&quot;</span><span class="p">)</span>
        <span class="n">cbow_excel_created</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ö†Ô∏è SKIP EXPORT CBOW - Data tidak tersedia&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Export memerlukan model CBOW dan embeddings yang sudah berhasil dibuat.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Silakan perbaiki masalah gensim terlebih dahulu.&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>üíæ EXPORT HASIL CBOW KE EXCEL MULTI-SHEET
==================================================
‚úÖ Excel CBOW berhasil dibuat dengan 5 sheet komprehensif:
   üìä CBOW_Analysis_Formatted.xlsx - Analisis lengkap CBOW
      ‚Ä¢ Sheet 1: Penjelasan_CBOW - Konsep dan teori CBOW vs TF-IDF
      ‚Ä¢ Sheet 2: Detail_Training - Sample word vectors dan similarity
      ‚Ä¢ Sheet 3: Analisis_Similarity - Top pasangan dokumen mirip
      ‚Ä¢ Sheet 4: Ringkasan_Embeddings - Summary document embeddings
      ‚Ä¢ Sheet 5: Statistik_Model - Comprehensive model statistics

üìà CBOW Analysis Summary:
   ‚Ä¢ Total documents analyzed: 655
   ‚Ä¢ Vocabulary size: 2,818
   ‚Ä¢ Vector dimensions: 100
   ‚Ä¢ Average document similarity: 0.280438
   ‚Ä¢ Top document similarity: 1.000000

============================================================
‚úÖ Excel CBOW berhasil dibuat dengan 5 sheet komprehensif:
   üìä CBOW_Analysis_Formatted.xlsx - Analisis lengkap CBOW
      ‚Ä¢ Sheet 1: Penjelasan_CBOW - Konsep dan teori CBOW vs TF-IDF
      ‚Ä¢ Sheet 2: Detail_Training - Sample word vectors dan similarity
      ‚Ä¢ Sheet 3: Analisis_Similarity - Top pasangan dokumen mirip
      ‚Ä¢ Sheet 4: Ringkasan_Embeddings - Summary document embeddings
      ‚Ä¢ Sheet 5: Statistik_Model - Comprehensive model statistics

üìà CBOW Analysis Summary:
   ‚Ä¢ Total documents analyzed: 655
   ‚Ä¢ Vocabulary size: 2,818
   ‚Ä¢ Vector dimensions: 100
   ‚Ä¢ Average document similarity: 0.280438
   ‚Ä¢ Top document similarity: 1.000000

============================================================
</pre></div>
</div>
</div>
</div>
</section>
<section id="perbandingan-hasil-tf-idf-vs-cbow">
<h1><strong>6. Perbandingan Hasil: TF-IDF vs CBOW</strong><a class="headerlink" href="#perbandingan-hasil-tf-idf-vs-cbow" title="Link to this heading">#</a></h1>
<p>Setelah menjalankan analisis <strong>TF-IDF</strong> dan <strong>CBOW</strong>, kita dapat membandingkan kedua pendekatan ini:</p>
<section id="perbedaan-pendekatan">
<h2><strong>üîç Perbedaan Pendekatan:</strong><a class="headerlink" href="#perbedaan-pendekatan" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Aspek</strong></p></th>
<th class="head"><p><strong>TF-IDF</strong></p></th>
<th class="head"><p><strong>CBOW</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Jenis Vector</strong></p></td>
<td><p>Sparse (jarang)</p></td>
<td><p>Dense (padat)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Dimensi</strong></p></td>
<td><p>Sebesar vocabulary (6,475)</p></td>
<td><p>Fixed (100 dimensi)</p></td>
</tr>
<tr class="row-even"><td><p><strong>Basis Perhitungan</strong></p></td>
<td><p>Frekuensi statistik</p></td>
<td><p>Semantic context</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Interpretasi</strong></p></td>
<td><p>Importance berdasarkan frekuensi</p></td>
<td><p>Similarity berdasarkan konteks</p></td>
</tr>
<tr class="row-even"><td><p><strong>Ukuran File</strong></p></td>
<td><p>Besar untuk sparse matrix</p></td>
<td><p>Lebih kecil untuk dense vectors</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="output-yang-dihasilkan">
<h2><strong>üìä Output yang Dihasilkan:</strong><a class="headerlink" href="#output-yang-dihasilkan" title="Link to this heading">#</a></h2>
<p><strong>TF-IDF Files:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TF_IDF_Analysis_Formatted.xlsx</span></code> - Analisis lengkap dalam Excel</p></li>
<li><p>Matrix TF-IDF untuk klasifikasi dan pencarian</p></li>
</ul>
<p><strong>CBOW Files:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CBOW_Document_Info.csv</span></code> - Informasi dokumen dengan embeddings</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CBOW_Document_Similarity_Matrix.csv</span></code> - Matrix similarity semantik</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CBOW_Top_Similar_Pairs.csv</span></code> - Pasangan dokumen paling mirip</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CBOW_Word_Embeddings.csv</span></code> - Word vectors untuk vocabulary</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CBOW_Model_Statistics.csv</span></code> - Statistik model CBOW</p></li>
</ul>
</section>
<section id="aplikasi-praktis">
<h2><strong>üí° Aplikasi Praktis:</strong><a class="headerlink" href="#aplikasi-praktis" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>TF-IDF</strong>: Cocok untuk information retrieval, klasifikasi teks, keyword extraction</p></li>
<li><p><strong>CBOW</strong>: Cocok untuk analisis semantic similarity, clustering berdasarkan makna, recommendation system</p></li>
</ul>
<p>Kedua pendekatan ini melengkapi satu sama lain dan dapat digunakan bersamaan tergantung pada tujuan analisis yang diinginkan.</p>
</section>
</section>
<section id="menghitung-dan-menyimpan-file-hasil-tf-idf">
<h1><strong>6. Menghitung dan Menyimpan File Hasil TF-IDF</strong><a class="headerlink" href="#menghitung-dan-menyimpan-file-hasil-tf-idf" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TF-IDF Analysis - Complete Implementation with Indonesian Labels</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="c1"># Siapkan data TF-IDF</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()</span>
<span class="n">tfidf_matrix</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">judul_jurnal</span> <span class="o">=</span> <span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;judul&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">idf_scores</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">idf_</span>

<span class="c1"># Buat TF-IDF table dengan kolom yang diminta</span>
<span class="n">tfidf_results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">doc_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">judul_jurnal</span><span class="p">)):</span>
    <span class="n">jurnal_name</span> <span class="o">=</span> <span class="n">judul_jurnal</span><span class="p">[</span><span class="n">doc_idx</span><span class="p">][:</span><span class="mi">80</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">judul_jurnal</span><span class="p">[</span><span class="n">doc_idx</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">80</span> <span class="k">else</span> <span class="n">judul_jurnal</span><span class="p">[</span><span class="n">doc_idx</span><span class="p">]</span>
    <span class="n">doc_tfidf</span> <span class="o">=</span> <span class="n">tfidf_matrix</span><span class="p">[</span><span class="n">doc_idx</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">term_idx</span><span class="p">,</span> <span class="n">tfidf_score</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">doc_tfidf</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">tfidf_score</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Hanya term yang muncul di dokumen</span>
            <span class="n">term</span> <span class="o">=</span> <span class="n">feature_names</span><span class="p">[</span><span class="n">term_idx</span><span class="p">]</span>
            <span class="n">idf_score</span> <span class="o">=</span> <span class="n">idf_scores</span><span class="p">[</span><span class="n">term_idx</span><span class="p">]</span>
            
            <span class="n">tfidf_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;Term&#39;</span><span class="p">:</span> <span class="n">term</span><span class="p">,</span>
                <span class="s1">&#39;Nama_Jurnal&#39;</span><span class="p">:</span> <span class="n">jurnal_name</span><span class="p">,</span>
                <span class="s1">&#39;IDF&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">idf_score</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                <span class="s1">&#39;TF_IDF&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">tfidf_score</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
            <span class="p">})</span>

<span class="c1"># Buat DataFrame TF-IDF</span>
<span class="n">tfidf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tfidf_results</span><span class="p">)</span>
<span class="n">tfidf_df</span> <span class="o">=</span> <span class="n">tfidf_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;TF_IDF&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Tambahkan nomor urut untuk kemudahan baca</span>
<span class="n">tfidf_df</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tfidf_df</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">tfidf_df</span> <span class="o">=</span> <span class="n">tfidf_df</span><span class="p">[[</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Term&#39;</span><span class="p">,</span> <span class="s1">&#39;Nama_Jurnal&#39;</span><span class="p">,</span> <span class="s1">&#39;IDF&#39;</span><span class="p">,</span> <span class="s1">&#39;TF_IDF&#39;</span><span class="p">]]</span>

<span class="c1"># Buat ringkasan per term</span>
<span class="n">term_stats</span> <span class="o">=</span> <span class="n">tfidf_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Term&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;IDF&#39;</span><span class="p">:</span> <span class="s1">&#39;first&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TF_IDF&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">]</span>
<span class="p">})</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">term_stats</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IDF&#39;</span><span class="p">,</span> <span class="s1">&#39;Frekuensi_Muncul&#39;</span><span class="p">,</span> <span class="s1">&#39;Rata_TF_IDF&#39;</span><span class="p">,</span> <span class="s1">&#39;Max_TF_IDF&#39;</span><span class="p">]</span>
<span class="n">term_stats</span> <span class="o">=</span> <span class="n">term_stats</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Rata_TF_IDF&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">term_stats</span><span class="p">[</span><span class="s1">&#39;Peringkat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">term_stats</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">term_stats</span> <span class="o">=</span> <span class="n">term_stats</span><span class="p">[[</span><span class="s1">&#39;Peringkat&#39;</span><span class="p">,</span> <span class="s1">&#39;Term&#39;</span><span class="p">,</span> <span class="s1">&#39;IDF&#39;</span><span class="p">,</span> <span class="s1">&#39;Frekuensi_Muncul&#39;</span><span class="p">,</span> <span class="s1">&#39;Rata_TF_IDF&#39;</span><span class="p">,</span> <span class="s1">&#39;Max_TF_IDF&#39;</span><span class="p">]]</span>

<span class="c1"># Coba buat file Excel dengan formatting profesional</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl</span><span class="w"> </span><span class="kn">import</span> <span class="n">Workbook</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl.styles</span><span class="w"> </span><span class="kn">import</span> <span class="n">Font</span><span class="p">,</span> <span class="n">PatternFill</span><span class="p">,</span> <span class="n">Border</span><span class="p">,</span> <span class="n">Side</span><span class="p">,</span> <span class="n">Alignment</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl.utils.dataframe</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataframe_to_rows</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">openpyxl.formatting.rule</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColorScaleRule</span>
    
    <span class="c1"># Buat workbook baru</span>
    <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
    
    <span class="c1"># Definisi styles</span>
    <span class="n">header_font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;FFFFFF&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">header_fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;366092&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;366092&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
    <span class="n">header_alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">wrap_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">data_font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">data_alignment_left</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="n">data_alignment_center</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="n">data_alignment_right</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    
    <span class="n">thin_border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span>
        <span class="n">left</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">),</span> <span class="n">right</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">),</span>
        <span class="n">top</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">),</span> <span class="n">bottom</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thin&#39;</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="c1"># Sheet 1: Penjelasan Rumus (Formula Explanation)</span>
    <span class="n">ws1</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
    <span class="n">ws1</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Penjelasan_Rumus&quot;</span>
    
    <span class="c1"># Penjelasan rumus dalam bahasa Indonesia</span>
    <span class="n">penjelasan_rumus</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s1">&#39;Metrik&#39;</span><span class="p">,</span> <span class="s1">&#39;Rumus&#39;</span><span class="p">,</span> <span class="s1">&#39;Penjelasan&#39;</span><span class="p">,</span> <span class="s1">&#39;Contoh&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;TF (Term Frequency)&#39;</span><span class="p">,</span> <span class="s1">&#39;TF = jumlah_term / total_kata_dalam_dokumen&#39;</span><span class="p">,</span> <span class="s1">&#39;Frekuensi kemunculan term dalam dokumen relatif terhadap panjang dokumen&#39;</span><span class="p">,</span> <span class="s1">&#39;Jika &quot;analisis&quot; muncul 3 kali dalam dokumen 100 kata: TF = 3/100 = 0.03&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;IDF (Inverse Document Frequency)&#39;</span><span class="p">,</span> <span class="s1">&#39;IDF = log(total_dokumen / dokumen_yang_mengandung_term)&#39;</span><span class="p">,</span> <span class="s1">&#39;Tingkat kepentingan term di seluruh koleksi dokumen&#39;</span><span class="p">,</span> <span class="s1">&#39;Jika &quot;analisis&quot; muncul di 50 dari 1000 dokumen: IDF = log(1000/50) = 2.996&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;TF-IDF&#39;</span><span class="p">,</span> <span class="s1">&#39;TF-IDF = TF √ó IDF&#39;</span><span class="p">,</span> <span class="s1">&#39;Gabungan skor kepentingan dan frekuensi&#39;</span><span class="p">,</span> <span class="s1">&#39;TF-IDF = 0.03 √ó 2.996 = 0.08988&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;Panduan Interpretasi&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;TF-IDF Tinggi (&gt;0.1)&#39;</span><span class="p">,</span> <span class="s1">&#39;Term sering muncul di dokumen DAN jarang di koleksi&#39;</span><span class="p">,</span> <span class="s1">&#39;Term yang sangat karakteristik untuk dokumen&#39;</span><span class="p">,</span> <span class="s1">&#39;Istilah teknis spesifik penelitian&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;TF-IDF Sedang (0.01-0.1)&#39;</span><span class="p">,</span> <span class="s1">&#39;Term yang cukup penting&#39;</span><span class="p">,</span> <span class="s1">&#39;Relevan tapi tidak unik untuk dokumen&#39;</span><span class="p">,</span> <span class="s1">&#39;Istilah penelitian umum&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;TF-IDF Rendah (&lt;0.01)&#39;</span><span class="p">,</span> <span class="s1">&#39;Term umum atau jarang muncul&#39;</span><span class="p">,</span> <span class="s1">&#39;Kurang karakteristik untuk dokumen&#39;</span><span class="p">,</span> <span class="s1">&#39;Kata umum, stopwords&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;Statistik Data Penelitian&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Total Dokumen Dianalisis&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">judul_jurnal</span><span class="p">)),</span> <span class="s1">&#39;Jumlah abstrak penelitian yang diproses&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Term Unik Ditemukan&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_names</span><span class="p">)),</span> <span class="s1">&#39;Ukuran kosakata setelah preprocessing&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Total Pasangan Term-Dokumen&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tfidf_df</span><span class="p">)),</span> <span class="s1">&#39;Nilai TF-IDF yang tidak nol&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Rata-rata Skor TF-IDF&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tfidf_df</span><span class="p">[</span><span class="s1">&#39;TF_IDF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;Rata-rata kepentingan semua term&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Skor TF-IDF Tertinggi&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tfidf_df</span><span class="p">[</span><span class="s1">&#39;TF_IDF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;Pasangan term-dokumen paling karakteristik&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;Tahapan Preprocessing Teks&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;1. Pembersihan Teks&#39;</span><span class="p">,</span> <span class="s1">&#39;Lowercasing, hapus angka &amp; tanda baca&#39;</span><span class="p">,</span> <span class="s1">&#39;Normalisasi teks untuk konsistensi&#39;</span><span class="p">,</span> <span class="s1">&#39;ANALISIS -&gt; analisis&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;2. Tokenisasi&#39;</span><span class="p">,</span> <span class="s1">&#39;Pemecahan kalimat menjadi kata&#39;</span><span class="p">,</span> <span class="s1">&#39;Memisahkan teks menjadi unit kata&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;data mining&quot; -&gt; [&quot;data&quot;, &quot;mining&quot;]&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;3. Stopwords Removal&#39;</span><span class="p">,</span> <span class="s1">&#39;Hapus kata umum (dan, atau, di, dll)&#39;</span><span class="p">,</span> <span class="s1">&#39;Fokus pada kata bermakna&#39;</span><span class="p">,</span> <span class="s1">&#39;[&quot;penelitian&quot;, &quot;dan&quot;, &quot;data&quot;] -&gt; [&quot;penelitian&quot;, &quot;data&quot;]&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;4. Stemming&#39;</span><span class="p">,</span> <span class="s1">&#39;Ubah kata ke bentuk dasar&#39;</span><span class="p">,</span> <span class="s1">&#39;Mengurangi variasi bentuk kata&#39;</span><span class="p">,</span> <span class="s1">&#39;penelitian -&gt; teliti, menganalisis -&gt; analisis&#39;</span><span class="p">]</span>
    <span class="p">]</span>
    
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">penjelasan_rumus</span><span class="p">:</span>
        <span class="n">ws1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    
    <span class="c1"># Format sheet penjelasan</span>
    <span class="k">for</span> <span class="n">row_idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ws1</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">penjelasan_rumus</span><span class="p">)),</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col_idx</span><span class="p">,</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">or</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="mi">11</span> <span class="ow">or</span> <span class="n">row_idx</span> <span class="o">==</span> <span class="mi">17</span><span class="p">:</span>  <span class="c1"># Headers</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;FFFFFF&quot;</span><span class="p">)</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;366092&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;366092&quot;</span><span class="p">,</span> <span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">]:</span>  <span class="c1"># Empty rows</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">col_idx</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Formula column</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Courier New&quot;</span><span class="p">)</span>
            
            <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">wrap_text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
    
    <span class="c1"># Set column widths untuk penjelasan sheet</span>
    <span class="n">ws1</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">ws1</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">45</span>
    <span class="n">ws1</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">40</span>
    <span class="n">ws1</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">45</span>
    
    <span class="c1"># Sheet 2: Perhitungan TF (TF Calculation Details)</span>
    <span class="n">ws2</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Perhitungan_TF&quot;</span><span class="p">)</span>
    
    <span class="c1"># Buat data TF calculation untuk beberapa dokumen pertama</span>
    <span class="n">tf_details</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">doc_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">judul_jurnal</span><span class="p">))):</span>  <span class="c1"># Ambil 15 dokumen pertama</span>
        <span class="n">jurnal_name</span> <span class="o">=</span> <span class="n">judul_jurnal</span><span class="p">[</span><span class="n">doc_idx</span><span class="p">][:</span><span class="mi">60</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">judul_jurnal</span><span class="p">[</span><span class="n">doc_idx</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">60</span> <span class="k">else</span> <span class="n">judul_jurnal</span><span class="p">[</span><span class="n">doc_idx</span><span class="p">]</span>
        <span class="n">doc_tfidf</span> <span class="o">=</span> <span class="n">tfidf_matrix</span><span class="p">[</span><span class="n">doc_idx</span><span class="p">]</span>
        
        <span class="c1"># Hitung total words dalam dokumen</span>
        <span class="n">doc_words</span> <span class="o">=</span> <span class="n">stemmed_texts</span><span class="p">[</span><span class="n">doc_idx</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">total_words</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc_words</span><span class="p">)</span>
        <span class="n">word_counts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">doc_words</span><span class="p">:</span>
            <span class="n">word_counts</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="n">word_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        
        <span class="c1"># Ambil top 8 terms untuk dokumen ini</span>
        <span class="n">doc_terms</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">doc_tfidf</span><span class="p">)</span> <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">doc_terms</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">term_idx</span><span class="p">,</span> <span class="n">tfidf_score</span> <span class="ow">in</span> <span class="n">doc_terms</span><span class="p">[:</span><span class="mi">8</span><span class="p">]:</span>  <span class="c1"># Top 8 terms</span>
            <span class="n">term</span> <span class="o">=</span> <span class="n">feature_names</span><span class="p">[</span><span class="n">term_idx</span><span class="p">]</span>
            <span class="n">term_frequency</span> <span class="o">=</span> <span class="n">word_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">tf_score</span> <span class="o">=</span> <span class="n">term_frequency</span> <span class="o">/</span> <span class="n">total_words</span> <span class="k">if</span> <span class="n">total_words</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
            
            <span class="n">tf_details</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;ID_Dokumen&#39;</span><span class="p">:</span> <span class="n">doc_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s1">&#39;Nama_Jurnal&#39;</span><span class="p">:</span> <span class="n">jurnal_name</span><span class="p">,</span>
                <span class="s1">&#39;Term&#39;</span><span class="p">:</span> <span class="n">term</span><span class="p">,</span>
                <span class="s1">&#39;Jumlah_Term&#39;</span><span class="p">:</span> <span class="n">term_frequency</span><span class="p">,</span>
                <span class="s1">&#39;Total_Kata&#39;</span><span class="p">:</span> <span class="n">total_words</span><span class="p">,</span>
                <span class="s1">&#39;Skor_TF&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">tf_score</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                <span class="s1">&#39;Rumus&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">term_frequency</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">total_words</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">})</span>
    
    <span class="n">tf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tf_details</span><span class="p">)</span>
    
    <span class="c1"># Tulis TF data</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">dataframe_to_rows</span><span class="p">(</span><span class="n">tf_df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">ws2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    
    <span class="c1"># Format header sheet 2</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws2</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">header_font</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">header_fill</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">header_alignment</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
    
    <span class="c1"># Set column widths untuk TF sheet</span>
    <span class="n">ws2_widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
    <span class="n">ws2_alignments</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_left</span><span class="p">,</span> <span class="n">data_alignment_left</span><span class="p">,</span>
                     <span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_center</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ws2_widths</span><span class="p">,</span> <span class="n">ws2_alignments</span><span class="p">)):</span>
        <span class="n">col_letter</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">65</span> <span class="o">+</span> <span class="n">idx</span><span class="p">)</span>
        <span class="n">ws2</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">col_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws2</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">data_font</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">alignment</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
                <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>  <span class="c1"># Count columns</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
                <span class="k">elif</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>  <span class="c1"># TF_Score</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0.000000&#39;</span>
    
    <span class="c1"># Conditional formatting untuk TF Score</span>
    <span class="n">ws2</span><span class="o">.</span><span class="n">conditional_formatting</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F2:F</span><span class="si">{</span><span class="n">ws2</span><span class="o">.</span><span class="n">max_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
                                  <span class="n">ColorScaleRule</span><span class="p">(</span><span class="n">start_type</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">start_color</span><span class="o">=</span><span class="s1">&#39;FFFFFF&#39;</span><span class="p">,</span>
                                               <span class="n">end_type</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s1">&#39;FFE699&#39;</span><span class="p">))</span>
    
    <span class="n">ws2</span><span class="o">.</span><span class="n">freeze_panes</span> <span class="o">=</span> <span class="s2">&quot;A2&quot;</span>
    <span class="n">ws2</span><span class="o">.</span><span class="n">auto_filter</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">ws2</span><span class="o">.</span><span class="n">dimensions</span>
    <span class="n">ws2</span><span class="o">.</span><span class="n">row_dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">30</span>
    
    <span class="c1"># Sheet 3: Perhitungan IDF (IDF Calculation Details)</span>
    <span class="n">ws3</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Perhitungan_IDF&quot;</span><span class="p">)</span>
    
    <span class="c1"># Buat data IDF calculation</span>
    <span class="n">idf_details</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">total_documents</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">judul_jurnal</span><span class="p">)</span>
    
    <span class="c1"># Ambil top 50 terms berdasarkan rata-rata TF-IDF</span>
    <span class="n">top_terms</span> <span class="o">=</span> <span class="n">term_stats</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">top_terms</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">term</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Term&#39;</span><span class="p">]</span>
        <span class="n">term_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">feature_names</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">term</span><span class="p">)</span>
        <span class="n">idf_score</span> <span class="o">=</span> <span class="n">idf_scores</span><span class="p">[</span><span class="n">term_idx</span><span class="p">]</span>
        
        <span class="c1"># Hitung berapa dokumen yang mengandung term ini</span>
        <span class="n">docs_containing_term</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">doc_tfidf</span> <span class="ow">in</span> <span class="n">tfidf_matrix</span> <span class="k">if</span> <span class="n">doc_tfidf</span><span class="p">[</span><span class="n">term_idx</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">calculated_idf</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">total_documents</span> <span class="o">/</span> <span class="n">docs_containing_term</span><span class="p">)</span> <span class="k">if</span> <span class="n">docs_containing_term</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        
        <span class="n">idf_details</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;Term&#39;</span><span class="p">:</span> <span class="n">term</span><span class="p">,</span>
            <span class="s1">&#39;Total_Dokumen&#39;</span><span class="p">:</span> <span class="n">total_documents</span><span class="p">,</span>
            <span class="s1">&#39;Dokumen_Mengandung_Term&#39;</span><span class="p">:</span> <span class="n">docs_containing_term</span><span class="p">,</span>
            <span class="s1">&#39;Skor_IDF&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">idf_score</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
            <span class="s1">&#39;IDF_Terhitung&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">calculated_idf</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
            <span class="s1">&#39;Rumus&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;log(</span><span class="si">{</span><span class="n">total_documents</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">docs_containing_term</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="s1">&#39;Persentase_Frekuensi&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">((</span><span class="n">docs_containing_term</span><span class="o">/</span><span class="n">total_documents</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">})</span>
    
    <span class="n">idf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">idf_details</span><span class="p">)</span>
    
    <span class="c1"># Tulis IDF data</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">dataframe_to_rows</span><span class="p">(</span><span class="n">idf_df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">ws3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    
    <span class="c1"># Format header sheet 3</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws3</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">header_font</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">header_fill</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">header_alignment</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
    
    <span class="c1"># Set column widths untuk IDF sheet</span>
    <span class="n">ws3_widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
    <span class="n">ws3_alignments</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_alignment_left</span><span class="p">,</span> <span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_center</span><span class="p">,</span>
                     <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ws3_widths</span><span class="p">,</span> <span class="n">ws3_alignments</span><span class="p">)):</span>
        <span class="n">col_letter</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">65</span> <span class="o">+</span> <span class="n">idx</span><span class="p">)</span>
        <span class="n">ws3</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">col_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws3</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">data_font</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">alignment</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
                <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>  <span class="c1"># Document counts</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
                <span class="k">elif</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]:</span>  <span class="c1"># IDF scores and percentage</span>
                    <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>  <span class="c1"># Percentage</span>
                        <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0.00%&#39;</span>
                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># IDF scores</span>
                        <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0.000000&#39;</span>
    
    <span class="c1"># Conditional formatting untuk frequency percentage</span>
    <span class="n">ws3</span><span class="o">.</span><span class="n">conditional_formatting</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;G2:G</span><span class="si">{</span><span class="n">ws3</span><span class="o">.</span><span class="n">max_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
                                  <span class="n">ColorScaleRule</span><span class="p">(</span><span class="n">start_type</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">start_color</span><span class="o">=</span><span class="s1">&#39;FF9999&#39;</span><span class="p">,</span>
                                               <span class="n">end_type</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s1">&#39;99FF99&#39;</span><span class="p">))</span>
    
    <span class="n">ws3</span><span class="o">.</span><span class="n">freeze_panes</span> <span class="o">=</span> <span class="s2">&quot;A2&quot;</span>
    <span class="n">ws3</span><span class="o">.</span><span class="n">auto_filter</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">ws3</span><span class="o">.</span><span class="n">dimensions</span>
    <span class="n">ws3</span><span class="o">.</span><span class="n">row_dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">30</span>
    
    <span class="c1"># Sheet 4: Tabel TF-IDF (Final Results)</span>
    <span class="n">ws4</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Tabel_TF_IDF&quot;</span><span class="p">)</span>
    
    <span class="c1"># Tulis data TF-IDF hasil akhir</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">dataframe_to_rows</span><span class="p">(</span><span class="n">tfidf_df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">ws4</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    
    <span class="c1"># Format header sheet 4</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws4</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">header_font</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">header_fill</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">header_alignment</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
    
    <span class="c1"># Set column widths dan format data</span>
    <span class="n">ws4_widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
    <span class="n">ws4_alignments</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_left</span><span class="p">,</span> <span class="n">data_alignment_left</span><span class="p">,</span> 
                     <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ws4_widths</span><span class="p">,</span> <span class="n">ws4_alignments</span><span class="p">)):</span>
        <span class="n">col_letter</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">65</span> <span class="o">+</span> <span class="n">idx</span><span class="p">)</span>
        <span class="n">ws4</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">col_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        
        <span class="c1"># Format data cells</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws4</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">data_font</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">alignment</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
                <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>  <span class="c1"># IDF dan TF_IDF columns</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0.000000&#39;</span>
    
    <span class="c1"># Conditional formatting untuk TF_IDF</span>
    <span class="n">ws4</span><span class="o">.</span><span class="n">conditional_formatting</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;E2:E</span><span class="si">{</span><span class="n">ws4</span><span class="o">.</span><span class="n">max_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
                                  <span class="n">ColorScaleRule</span><span class="p">(</span><span class="n">start_type</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">start_color</span><span class="o">=</span><span class="s1">&#39;FFFFFF&#39;</span><span class="p">,</span>
                                               <span class="n">mid_type</span><span class="o">=</span><span class="s1">&#39;percentile&#39;</span><span class="p">,</span> <span class="n">mid_value</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">mid_color</span><span class="o">=</span><span class="s1">&#39;FFE699&#39;</span><span class="p">,</span>
                                               <span class="n">end_type</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s1">&#39;FF9999&#39;</span><span class="p">))</span>
    
    <span class="c1"># Freeze panes dan filter</span>
    <span class="n">ws4</span><span class="o">.</span><span class="n">freeze_panes</span> <span class="o">=</span> <span class="s2">&quot;A2&quot;</span>
    <span class="n">ws4</span><span class="o">.</span><span class="n">auto_filter</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">ws4</span><span class="o">.</span><span class="n">dimensions</span>
    <span class="n">ws4</span><span class="o">.</span><span class="n">row_dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">30</span>
    
    <span class="c1"># Sheet 5: Statistik Term (Term Statistics)</span>
    <span class="n">ws5</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&quot;Statistik_Term&quot;</span><span class="p">)</span>
    
    <span class="c1"># Tulis data ringkasan term statistics</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">dataframe_to_rows</span><span class="p">(</span><span class="n">term_stats</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">ws5</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    
    <span class="c1"># Format header sheet 5</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">ws5</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">header_font</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">header_fill</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">header_alignment</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
    
    <span class="c1"># Set column widths dan format untuk sheet 5</span>
    <span class="n">ws5_widths</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
    <span class="n">ws5_alignments</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_left</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span>
                     <span class="n">data_alignment_center</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">,</span> <span class="n">data_alignment_right</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">alignment</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ws5_widths</span><span class="p">,</span> <span class="n">ws5_alignments</span><span class="p">)):</span>
        <span class="n">col_letter</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">65</span> <span class="o">+</span> <span class="n">idx</span><span class="p">)</span>
        <span class="n">ws5</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="n">col_letter</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        
        <span class="c1"># Format data cells</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws5</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">data_font</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">alignment</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">thin_border</span>
                <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>  <span class="c1"># Numerical columns</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0.000000&#39;</span>
                <span class="k">elif</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># Frekuensi column</span>
                    <span class="n">cell</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
    
    <span class="c1"># Conditional formatting untuk rata TF_IDF</span>
    <span class="n">ws5</span><span class="o">.</span><span class="n">conditional_formatting</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;E2:E</span><span class="si">{</span><span class="n">ws5</span><span class="o">.</span><span class="n">max_row</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> 
                                  <span class="n">ColorScaleRule</span><span class="p">(</span><span class="n">start_type</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">start_color</span><span class="o">=</span><span class="s1">&#39;E8F5E8&#39;</span><span class="p">,</span>
                                               <span class="n">end_type</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s1">&#39;4CAF50&#39;</span><span class="p">))</span>
    
    <span class="c1"># Freeze panes dan filter untuk sheet 5</span>
    <span class="n">ws5</span><span class="o">.</span><span class="n">freeze_panes</span> <span class="o">=</span> <span class="s2">&quot;A2&quot;</span>
    <span class="n">ws5</span><span class="o">.</span><span class="n">auto_filter</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">ws5</span><span class="o">.</span><span class="n">dimensions</span>
    <span class="n">ws5</span><span class="o">.</span><span class="n">row_dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">30</span>
    
    <span class="c1"># Simpan Excel</span>
    <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;TF_IDF_Analysis_Formatted.xlsx&#39;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ Excel file created with comprehensive TF-IDF analysis:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   üìä TF_IDF_Analysis_Formatted.xlsx - Analisis lengkap dengan 5 sheet terurut&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ‚Ä¢ Sheet 1: Penjelasan_Rumus - Panduan lengkap rumus dan interpretasi (Bahasa Indonesia)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ‚Ä¢ Sheet 2: Perhitungan_TF - Detail perhitungan Term Frequency&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ‚Ä¢ Sheet 3: Perhitungan_IDF - Detail perhitungan Inverse Document Frequency&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ‚Ä¢ Sheet 4: Tabel_TF_IDF - Hasil akhir dengan conditional formatting&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;      ‚Ä¢ Sheet 5: Statistik_Term - Ringkasan statistik dengan peringkat&quot;</span><span class="p">)</span>
    <span class="n">excel_created</span> <span class="o">=</span> <span class="kc">True</span>
    
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚ö†Ô∏è openpyxl not available - creating CSV files instead:&quot;</span><span class="p">)</span>
    
    <span class="c1"># Simpan ke CSV dengan formatting yang rapi</span>
    <span class="n">tfidf_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;TF_IDF_Table.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.6f</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">term_stats</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;Term_Statistics.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.6f</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   üìÑ TF_IDF_Table.csv - Main TF-IDF data with numbering&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   üìÑ Term_Statistics.csv - Term summary with rankings&quot;</span><span class="p">)</span>
    <span class="n">excel_created</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìà Analysis Summary:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Total term-document pairs: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tfidf_df</span><span class="p">)</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Unique terms: </span><span class="si">{</span><span class="n">tfidf_df</span><span class="p">[</span><span class="s1">&#39;Term&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Documents analyzed: </span><span class="si">{</span><span class="n">tfidf_df</span><span class="p">[</span><span class="s1">&#39;Nama_Jurnal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Top TF-IDF score: </span><span class="si">{</span><span class="n">tfidf_df</span><span class="p">[</span><span class="s1">&#39;TF_IDF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   ‚Ä¢ Average TF-IDF score: </span><span class="si">{</span><span class="n">tfidf_df</span><span class="p">[</span><span class="s1">&#39;TF_IDF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="s1">&#39;excel_created&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">excel_created</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üí° Excel file contains all data with professional formatting - CSV files not needed!&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üí° Use CSV files for data analysis or install openpyxl for better Excel formatting.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>‚úÖ Excel file created with comprehensive TF-IDF analysis:
   üìä TF_IDF_Analysis_Formatted.xlsx - Analisis lengkap dengan 5 sheet terurut
      ‚Ä¢ Sheet 1: Penjelasan_Rumus - Panduan lengkap rumus dan interpretasi (Bahasa Indonesia)
      ‚Ä¢ Sheet 2: Perhitungan_TF - Detail perhitungan Term Frequency
      ‚Ä¢ Sheet 3: Perhitungan_IDF - Detail perhitungan Inverse Document Frequency
      ‚Ä¢ Sheet 4: Tabel_TF_IDF - Hasil akhir dengan conditional formatting
      ‚Ä¢ Sheet 5: Statistik_Term - Ringkasan statistik dengan peringkat

üìà Analysis Summary:
   ‚Ä¢ Total term-document pairs: 40,184
   ‚Ä¢ Unique terms: 4,850
   ‚Ä¢ Documents analyzed: 649
   ‚Ä¢ Top TF-IDF score: 0.823313
   ‚Ä¢ Average TF-IDF score: 0.084527

üí° Excel file contains all data with professional formatting - CSV files not needed!
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tugas_4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>1. Pembersihan Teks</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#tokenisasi"><strong>2. Tokenisasi</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#penghapusan-kata-umum-stop-words"><strong>3. Penghapusan Kata Umum (Stop Words)</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stemming-dan-lematisasi"><strong>4. Stemming dan Lematisasi</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#word-embeddings-dengan-cbow-continuous-bag-of-words"><strong>5. Word Embeddings dengan CBOW (Continuous Bag of Words)</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#perbandingan-hasil-tf-idf-vs-cbow"><strong>6. Perbandingan Hasil: TF-IDF vs CBOW</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perbedaan-pendekatan"><strong>üîç Perbedaan Pendekatan:</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output-yang-dihasilkan"><strong>üìä Output yang Dihasilkan:</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplikasi-praktis"><strong>üí° Aplikasi Praktis:</strong></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#menghitung-dan-menyimpan-file-hasil-tf-idf"><strong>6. Menghitung dan Menyimpan File Hasil TF-IDF</strong></a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>